(function(t){function e(e){for(var n,r,s=e[0],c=e[1],l=e[2],u=0,d=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,s=1;s<i.length;s++){var c=i[s];0!==a[c]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=i[0]))}return t}var n={},a={app:0},o=[];function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var h=c;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},2531:function(t,e,i){},4250:function(t,e,i){},4630:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create"},[i("div",{staticClass:"btn-box",staticStyle:{width:"200px"}},[i("button",{staticClass:"btn",on:{click:t.add}},[t._v("add")]),i("button",{staticClass:"btn",on:{click:t.add2}},[t._v("添加到激活")]),i("button",{staticClass:"btn",on:{click:function(e){return t.move("up")}}},[t._v("上")]),i("button",{staticClass:"btn",on:{click:function(e){return t.move("down")}}},[t._v("下")]),i("button",{staticClass:"btn",on:{click:function(e){return t.move("top")}}},[t._v("顶")]),i("button",{staticClass:"btn",on:{click:function(e){return t.move("bottom")}}},[t._v("底")]),i("button",{staticClass:"btn",on:{click:t.initTreeEvt}},[t._v("初始化画布")]),i("div",{staticClass:"edit"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.width,expression:"width"}],attrs:{type:"text"},domProps:{value:t.width},on:{input:function(e){e.target.composing||(t.width=e.target.value)}}}),i("button",{staticClass:"btn",on:{click:t.edit}},[t._v("修改画布尺寸")])])]),i("pdDragBase",{ref:"sketch",attrs:{beforeCopy:t.beforeCopy,beforeDelete:t.beforeDelete,ruleConfig:{frameSelectType:"touch",scale:3.7795276}},on:{listener:t.getBus}},[i("div",[t._v("xx")])]),i("div",{staticStyle:{width:"200px"}},[i("input",{attrs:{type:"text"}}),t._v(" "+t._s(t.selected)+" ")])],1)},o=[],r=(i("d3b7"),{name:"create",data:function(){return{rightMenu:[{type:"xxx",evt:this.rightText}],bus:{selected:[]},selected:[],width:100,initTree:{type:"sketchup",width:100,height:200,to:0,left:0,children:[]}}},mounted:function(){var t=this;this.$nextTick((function(){t.$refs.sketch.$bind("addend",(function(e){t.$refs.sketch.selectById(e[0])})),document.addEventListener("keyup",(function(e){t.shift&&t.bus.$pureFire("shift",!1)})),document.addEventListener("keydown",(function(e){e.shiftKey&&(t.shift=!0,t.bus.$pureFire("shift",!0))}))}))},methods:{initTreeEvt:function(){this.$refs.sketch.$fire("initTree",this.initTree)},move:function(t){switch(t){case"up":this.bus.$fire("bringForward",{id:this.selected[0].id});break;case"down":this.bus.$fire("sendBackward",{id:this.selected[0].id});break;case"top":this.bus.$fire("bringToFront",{id:this.selected[0].id});break;case"bottom":this.bus.$fire("sendToBack",{id:this.selected[0].id});break}},add:function(){this.bus.$fire("addToSketch",{item:[{left:148,top:63,rotate:0,width:31,height:38,active:!0,childActiveAble:!1,type:"dtext",children:[],id:"e7c02a03-0142-4af1-a49d-2e09461d1909",parentId:"4d7438ad-fe8c-4356-89f0-b0385c81b811"},{left:58,top:87,rotate:0,width:50,height:50,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"16ddeef0-9c50-477f-8ff7-07d24e7d8920",parentId:"4d7438ad-fe8c-4356-89f0-b0385c81b811",initXY:{}},{left:6,top:3,rotate:0,width:56,height:75,type:"dragdropbox",id:"432cb02c-a9fa-4a48-baa5-0c529636243a",parentId:"4d7438ad-fe8c-4356-89f0-b0385c81b811",initXY:{},active:!1,childActiveAble:!1,children:[{left:0,top:0,rotate:0,width:42,height:43,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"6547406f-103a-4a12-b65f-599a876bb712",parentId:"432cb02c-a9fa-4a48-baa5-0c529636243a",initXY:{}},{left:28,top:57,rotate:0,width:28,height:18,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"25f597b4-955b-439a-9157-38220f46040f",parentId:"432cb02c-a9fa-4a48-baa5-0c529636243a",initXY:{}}]}]})},add2:function(){this.bus.$fire("addToSketch",{parent:1===this.selected.length?this.selected[0]:null,item:[{left:10,top:20,rotate:0,width:50,height:50,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"4b133596-62ee-4e70-b3ae-bd93a5482fa6",parentId:null,initXY:{}}]})},edit:function(){this.$refs.sketch.$fire("updateItem",{id:this.$refs.sketch.sketchupData.id,data:{width:this.width}})},beforeCopy:function(t){return console.log(t,"beforeCopy"),new Promise((function(e){e(t)}))},beforeDelete:function(t){return console.log(t,"beforeDelete"),!0},getBus:function(t){this.bus=this.$refs.sketch}},watch:{"bus.selected":{handler:function(t){this.selected=t},deep:!0}}}),s=r,c=(i("f345"),i("2877")),l=Object(c["a"])(s,a,o,!1,null,null,null),h=l.exports,u=(i("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-text"},[t._v("text")])}),d=[],p={name:"dtext",props:{renderData:{type:Object,required:!0},type:{type:String,default:function(){return"lib"}}}},f=p,m=(i("ca8c"),Object(c["a"])(f,u,d,!1,null,"ad972faa",null)),v=m.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v("img")])},y=[],b={name:"imgsrc",props:{renderData:{type:Object,required:!0},type:{type:String,default:function(){return"lib"}}}},k=b,x=Object(c["a"])(k,g,y,!1,null,"14975443",null),w=x.exports,S={dtext:v,imgsrc:w};if(n["a"])for(var M in S)n["a"].component(S[M].name,S[M]);i("d81d");var $=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"hotkey",rawName:"v-hotkey",value:t.keymap,expression:"keymap"},{name:"pd-ruler",rawName:"v-pd-ruler",value:t.ruleOpt.scale,expression:"ruleOpt.scale"},{name:"frameselect",rawName:"v-frameselect",value:{excluded:t.$refs.box,selected:t.selectedEvt,type:t.ruleOpt.frameSelectType},expression:"{excluded:$refs.box,selected:selectedEvt,type:ruleOpt.frameSelectType}"}],staticClass:"sketch-box",on:{mousedown:t.cleanSelect}},[i("div",{staticClass:"layer-box"},[i("div",{staticClass:"layer-content",style:t.getLayerSize},[[i("div",{staticClass:"sketch-stage"},[t._t("default")],2)],i("div",{ref:"box",staticClass:"item-box"},[t._l(t.sketchupData.children,(function(e,n){return i("resizeable",{key:e.id,ref:"resizeable",refInFor:!0,attrs:{"z-index":n,element:e,ShiftKey:t.ShiftKey},on:{"update:element":function(t){e=t},refLineParams:t.getRefLineParams}})})),t._l(t.vLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line v-line",style:{left:t.position,top:t.origin,height:t.lineLength}})})),t._l(t.hLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line h-line",style:{top:t.position,left:t.origin,width:t.lineLength}})}))],2)],2)])])},L=[],O=(i("4160"),i("b680"),i("b64b"),i("acd8"),i("159b"),i("5530")),I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.element?i("pdDragResizeRotate",{class:t.setDragDropBoxClass(),attrs:{"pd-id":t.element.id,x:t.mm2px(t.element.left),y:t.mm2px(t.element.top),w:t.mm2px(t.element.width),h:t.mm2px(t.element.height),lock:t.isLock,z:t.zIndex,r:t.element.rotate||0,activeable:t.activeable,active:t.element.active,draggable:t.draggable(t.element.id),resizeable:t.resizeable(t.element),rotateable:t.rotateable(t.element),sticks:t.sticks},on:{dragStop:t.dragStop,dragStart:t.dragStart,dragging:t.dragging,resizeStart:t.resizeStart,resizeStop:t.resizeStop,rotateStart:t.rotateStart,rotateStop:t.rotateStop,activated:function(e){return t.beforeSelect(e,t.element)},refLineParams:function(e){t.$emit("refLineParams",e)}},nativeOn:{dblclick:function(e){return t.parentActiveChild(e)}}},[i(t.element.type,{tag:"component",attrs:{renderData:t.element}},[t.element.children.length?[t._l(t.element.children,(function(e,n){return i("resizeable",{key:e.id,attrs:{element:e,zIndex:n,activeable:t.element.childActiveAble},on:{"update:element":function(t){e=t},parentSelect:t.beforeSelect,parentActiveChild:t.parentActiveChild,refLineParams:t.getRefLineParams}})})),t._l(t.vLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line v-line",style:{left:t.position,top:t.origin,height:t.lineLength}})})),t._l(t.hLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line h-line",style:{top:t.position,left:t.origin,width:t.lineLength}})}))]:t._e()],2)],1):t._e()},N=[],D=(i("c740"),i("a9e3"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"drag-drop-box"},[t._t("default")],2)}),E=[],C=(i("baa5"),i("0d03"),i("25f0"),i("3ca3"),i("ddb0"),i("4795"),i("2b3d"),i("53ca"));function T(){var t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.substr(e.lastIndexOf("/")+1)}function P(t){return!!t&&("object"===Object(C["a"])(t)||"function"===typeof t)&&"function"===typeof t.then}function R(t){return"[object Array]"==Object.prototype.toString.call(t)}function z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=null,n=!0;return function(){for(var a=this,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];if(n)return t.apply(this,r),n=!1;i||(i=setTimeout((function(){clearTimeout(i),i=null,t.apply(a,r)}),e))}}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0,i=0,n=0,a=0,o=!0;if(R(t))for(var r=0;r<t.length;++r){var s=t[r];if(s){if(void 0===s.left||void 0===s.top||void 0===s.width||void 0===s.height){o=!1;break}var c={mx:s.left,my:s.top};c.mx,c.my;0===r&&(e=s.left,i=s.top),s.left<=e&&(e=s.left),s.top<=i&&(i=s.top);var l=Number(s.left)+Number(s.width);l>=n&&(n=l);var h=Number(s.top)+Number(s.height);h>=a&&(a=h)}}return o?{left:e,top:i,width:n-e,height:a-i}:{left:0,top:0,width:0,height:0}}function A(t,e,i,n){var a=t.left,o=t.top,r=t.right,s=t.bottom,c=e.left,l=e.top,h=e.right,u=e.bottom;switch(i){case"fit":return c<=a&&r<=h&&l<=o&&s<=u;case"intersect_x":return c<a+(t.right-t.left)/2&&r-(t.right-t.left)/2<h;case"intersect":return c<a+(t.right-t.left)/2&&r-(t.right-t.left)/2<h&&l<o+(t.bottom-t.top)/2&&s-(t.bottom-t.top)/2<u;case"pointer":return j(n.pageY,l,t.bottom-t.top)&&j(n.pageX,c,t.right-t.left);case"touch":return(o>=l&&o<=u||s>=l&&s<=u||o<l&&s>u)&&(a>=c&&a<=h||r>=c&&r<=h||a<c&&r>h);default:return!1}}function j(t,e,i){return t>=e&&t<e+i}function H(t,e){do{if(t.classList&&t.classList.contains(e))return!0;t=t.parentNode}while(t);return!1}function X(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}i("a434"),i("ac1f"),i("5319"),i("1276");var Y=i("d4ec"),W={type:"dragdropbox"};function B(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{id:null};if(e.id=T(),e.parentId=i.id,e=Object(O["a"])(Object(O["a"])({left:0,top:0,rotate:0,width:50,height:50},e),{},{active:!1,childActiveAble:!1}),e.children&&e.children.length)for(var n=0;n<e.children.length;++n)e.children[n]=B(t,e.children[n],e);else e.children=[];return t.sketchupMap[e.id]=e,e}function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){t.active=!1,t.childActiveAble=!1;for(var e=0;e<t.children.length;++e)t.children[e]=F(t.children[e]);return t}}function J(t,e,i,n,a,o){e.forEach((function(e){t.sketchupMap[e.id].left=t.sketchupMap[e.id].left-o.left,t.sketchupMap[e.id].top=t.sketchupMap[e.id].top-o.top,t.sketchupMap[e.id].parentId=a.id,n.push(t.sketchupMap[e.id]);var r=i.findIndex((function(t){return e.id===t.id}));i.splice(r,1)})),i.push(a)}function G(t,e,i,n,a){e.children.map((function(e){t.sketchupMap[e.id].parentId=a,t.sketchupMap[e.id].top=t.sketchupMap[e.id].top+n.top,t.sketchupMap[e.id].left=t.sketchupMap[e.id].left+n.left,i.push(t.sketchupMap[e.id])}));var o=i.findIndex((function(t){return t.id===e.id}));i.splice(o,1),delete t.sketchupMap[e.id]}function K(t,e,i){var n=t;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var a=e.split("."),o=0,r=a.length;o<r-1;++o){var s=a[o];s in n&&(n=n[s])}n[a[o]]=i}function V(t,e,i){var n=t;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var a=e.split("."),o=0,r=a.length;o<r-1;++o){var s=a[o];s in n&&(n=n[s])}return JSON.parse(JSON.stringify(n[a[o]]))}function q(t){var e=t.event,i=t.id;U.call(this,{event:e,id:i});var a=this.state,o=a.selected;F(a.sketchupMap[i]),a.sketchupMap[i].active=!0,e.ctrlKey?o.push(a.sketchupMap[i]):o=[a.sketchupMap[i]],a.selected=o,this.$emit("selected",a.selected),n["a"].set(a,"sketchup",a.sketchup)}function U(t){for(var e=t.event,i=t.id,n=void 0===i?null:i,a=this.state,o=a.selected,r=a.sketchupMap[n]||{},s=0;s<o.length;s++){var c=o[s];if(c.id!==r.parentId&&a.sketchupMap[c.id]){var l=a.sketchupMap[c.id].parentId,h=!1;while(l){if(l===r.parentId){e.ctrlKey||(F(a.sketchupMap[c.id]),h=!0);break}F(a.sketchupMap[l]),l=a.sketchupMap[l].parentId,h=!0}h&&(o.splice(s,1),s--)}}a.selected=o}function Z(t,e){var i=e.id;if(t.sketchupMap[i]=e,e.children&&e.children.length)for(var n=0;n<e.children.length;++n)Z(t,e.children[n])}var Q=function t(){return Object(Y["a"])(this,t),this.init||(this.init=!0,this.bus=new n["a"]({computed:{selected:function(){return JSON.parse(JSON.stringify(this.state.selected))}},data:function(){return{state:{sketchup:{},sketchupMap:{},selected:[],copyData:null,snapshotStack:[],snapshotLength:10,snapshotIndex:-1}}},created:function(){var t=this;this.$on("addToSketch",(function(e){var i=e.parent,n=void 0===i?null:i,a=e.item,o=e.index,r=void 0===o?-1:o,s=t.state,c=[];n=n||s.sketchup,R(a)?a.forEach((function(t){t=JSON.parse(JSON.stringify(t)),n.type===W.type?(t=B(s,t,n),c.push(t.id),-1===r?s.sketchupMap[n.id].children.push(t):s.sketchupMap[n.id].children.splice(r,0,t)):(t=B(s,t,s.sketchup),c.push(t.id),-1===r?s.sketchup.children.push(t):s.sketchup.children.splice(r,0,t))})):(a=JSON.parse(JSON.stringify(a)),a=B(s,a,n),c.push(a.id),n?-1===r?s.sketchupMap[n.id].push(a):s.sketchupMap[n.id].splice(r,0,a):-1===r?s.sketchup.children.push(a):s.sketchup.children.splice(r,0,a)),t.$nextTick((function(){t.$emit("updateGroup"),t.$emit("addend",c)}))})),this.$on("select",(function(e){var i=e.event,n=void 0===i?{}:i,a=e.id,o=void 0===a?null:a,r=t.state;if(o){var s=r.sketchupMap[o],c=-1;c=r.selected.findIndex((function(t){return t.id==s.id})),(c>-1&&n.ctrlKey||c<0)&&q.call(t,{event:n,id:o})}})),this.$on("unSelect",(function(e){var i=e.event,a=void 0===i?{}:i,o=e.id,r=t.state;U.call(t,{event:a,id:o}),t.$emit("selected",r.selected),n["a"].set(r,"sketchup",r.sketchup)})),this.$on("cleanSelect",(function(){var e=t.state,i=e.selected.length-1;while(i>=0){var a=e.selected[i];if(!a||!a.parentId)break;U.call(t,{event:{ctrlKey:!1},id:null}),--i}e.selected=[],t.$emit("selected",e.selected),n["a"].set(e,"sketchup",e.sketchup)})),this.$on("updateSelected",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=t.state;if(e&&(!e||0!==Object.keys(e).length)){var a=i.selected[i.selected.length-1]||null;if(a&&!(a.length>1)){var o={ids:a.id,data:{}};for(var r in e)o.data[r]=V(i.sketchupMap[a.id],r),K(i.sketchupMap[a.id],r,e[r]);n["a"].set(i,"sketchup",i.sketchup)}}})),this.$on("removeSelected",(function(){var e,i,a=t.state,o=a.selected,r=!1,s=a.sketchupMap;R(o)&&o.length&&(r=!0,o.map((function(n){e=s[s[n.id].parentId],t.$emit("unSelect",{id:n.id}),e?(i=e.children.findIndex((function(t){return t.id===n.id})),e.children.splice(i,1)):(i=a.sketchup.children.findIndex((function(t){return t.id===n.id})),a.sketchup.children.splice(i,1)),a.sketchupMap[n.id].children.map((function(t){delete a.sketchupMap[t.id]})),delete a.sketchupMap[n.id]}))),t.$emit("updateGroup"),r&&n["a"].set(a,"sketchup",a.sketchup)})),this.$on("copySelected",(function(e){t.state.copyData=JSON.parse(JSON.stringify(e))})),this.$on("paste",(function(){var e=t.state;if(e.copyData){t.$emit("recordShot");var i=JSON.parse(JSON.stringify(e.copyData)),n=i.length>0,a=e.selected[0]?e.selected[0].parentId:null;i.forEach((function(t){t.left+=10,t.top+=10,t=B(e,t,{id:a}),a?e.sketchupMap[a].children.push(t):e.sketchup.children.push(t)}));var o=JSON.parse(JSON.stringify(e.selected));o.forEach((function(e){t.$emit("unSelect",{id:e.id,event:{ctrlKey:!1}})})),i.forEach((function(e){t.$emit("select",{id:e.id,event:{ctrlKey:n}})})),e.copyData=JSON.parse(JSON.stringify(i)),t.$emit("updateGroup")}})),this.$on("group",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.state;e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault();var a=i.selected;if(R(a)&&a.length>1){var o=i.selected[0].parentId,r=JSON.parse(JSON.stringify(W)),s=_(a);r=Object(O["a"])(Object(O["a"])({},r),s),r=B(i,r,{id:o}),J(i,a,o?i.sketchupMap[o].children:i.sketchup.children,i.sketchupMap[r.id].children,r,s),t.$emit("unSelect",{id:r.id}),t.$emit("select",{id:r.id}),n["a"].set(i,"sketchup",i.sketchup)}})),this.$on("breakGroup",(function(){var e,i=t.state,n=i.selected;if(n&&0!==n.length&&0!==Object.keys(n).length)if(R(n))n.map((function(n){var a=n.left,o=n.top,r=n.parentId,s=r,c=i.sketchupMap[s]?i.sketchupMap[s].children:i.sketchup.children;e={left:a,top:o},n.type===W.type&&n.children.length&&(G(i,n,c,e,s),n.children.map((function(e){t.$emit("unSelect",{event:{ctrlKey:!0},id:e.id}),t.$emit("select",{event:{ctrlKey:!0},id:e.id})})))}));else{var a=n.left,o=n.top,r=n.parentId,s=r,c=i.sketchupMap[s]?i.sketchupMap[s].children:i.sketchup.children;e={left:a,top:o},n.type===W.type&&n.children.length&&(G(i,n,c,e,s),t.$emit("cleanSelect"),n.children.map((function(e){t.$emit("unSelect",{event:{ctrlKey:!0},id:e.id}),t.$emit("select",{event:{ctrlKey:!0},id:e.id})})))}})),this.$on("updateGroupBox",(function(e){var i=e.id,n=e.coord,a=t.state;a.sketchupMap[i]&&(a.sketchupMap[i].left=a.sketchupMap[i].left+n.left,a.sketchupMap[i].top=a.sketchupMap[i].top+n.top,a.sketchupMap[i].width=n.width,a.sketchupMap[i].height=n.height,a.sketchupMap[i].children.map((function(t){a.sketchupMap[t.id].left=a.sketchupMap[t.id].left-n.left,a.sketchupMap[t.id].top=a.sketchupMap[t.id].top-n.top})))})),this.$on("initTree",(function(e){var i=t.state;i.sketchupMap={},i.sketchup={},i.selected=[],i.copyData=null,e.type="sketchup",e=JSON.parse(JSON.stringify(e)),e=B(i,e,{}),i.sketchup=e})),this.$on("updateItem",(function(e){var i=e.id,a=e.data,o=void 0===a?null:a,r=e.updateGroupBox,s=void 0===r||r,c=t.state;if(o&&c.sketchupMap[i]){var l={ids:i,data:{}};for(var h in o)s&&(l.data[h]=V(c.sketchupMap[i],h)),K(c.sketchupMap[i],h,o[h]);s&&t.$emit("updateGroup"),n["a"].set(c,"sketchup",c.sketchup)}})),this.$on("bringForward",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],r=o.children.findIndex((function(t){return t.id===i}));r!==o.children.length-1&&(n.sketchupMap[a.parentId].children[r]=n.sketchupMap[a.parentId].children.splice(r+1,1,n.sketchupMap[a.parentId].children[r])[0])}})),this.$on("sendBackward",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],r=o.children.findIndex((function(t){return t.id===i}));0!==r&&(n.sketchupMap[a.parentId].children[r]=n.sketchupMap[a.parentId].children.splice(r-1,1,n.sketchupMap[a.parentId].children[r])[0])}})),this.$on("bringToFront",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],r=o.children.findIndex((function(t){return t.id===i}));r!==o.children.length-1&&n.sketchupMap[a.parentId].children.push(n.sketchupMap[a.parentId].children.splice(r,1)[0])}})),this.$on("sendToBack",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],r=o.children.findIndex((function(t){return t.id===i}));0!==r&&n.sketchupMap[a.parentId].children.unshift(n.sketchupMap[a.parentId].children.splice(r,1)[0])}})),this.$on("recordShot",(function(){t.state.snapshotStack[++t.state.snapshotIndex]={select:JSON.parse(JSON.stringify(t.state.selected)),data:JSON.parse(JSON.stringify(t.state.sketchup))},t.state.snapshotStack.length>t.state.snapshotLength&&(t.state.snapshotStack.shift(),t.state.snapshotIndex--)})),this.$on("undo",(function(){if(t.state.snapshotIndex>=0){t.state.sketchupMap={};var e=t.state.snapshotStack[t.state.snapshotIndex];if(!e)return;t.state.snapshotIndex--,Z(t.state,e.data),t.state.selected=e.select,n["a"].set(t.state,"sketchup",e.data)}})),this.$on("redo",(function(){if(t.state.snapshotIndex<=t.state.snapshotStack.length){t.state.sketchupMap={},t.state.snapshotIndex++;var e=t.state.snapshotStack[t.state.snapshotIndex];if(!e)return;Z(t.state,e.data),t.state.selected=e.select,n["a"].set(t.state,"sketchup",e.data)}}))}})),this.bus},tt=new Q,et={name:"dragdropbox",props:{renderData:{type:Object,required:!0}},mounted:function(){tt.$on("updateGroup",this.trigger)},methods:{trigger:function(){var t=this;this.$nextTick((function(){tt.$emit("updateGroupBox",{id:t.renderData.id,coord:Object(O["a"])({},_(t.renderData.children))})}))}},beforeDestroy:function(){tt.$off("updateGroup",this.trigger)}},it=et,nt=(i("b64f"),Object(c["a"])(it,D,E,!1,null,"2c748eec",null)),at=nt.exports,ot=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"vdr",staticClass:"vdr",class:{"vdr-active":t.active&&t.activeable,"vdr-not-active":!t.activeable},style:t.style,on:{mousedown:function(e){return t.bodyDown(e)}}},[t.active&&t.activeable?[t.resizeable?t._l(t.rotateSticks,(function(e,n){return i("span",{key:n,staticClass:"vdr-stick",class:"vdr-stick-"+e,style:{zIndex:t.activeStick==n?10:9},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),t.stickDown(i,e,n)}}})})):t._e(),t.sticks.indexOf("angle")>-1&&t.rotateable?[i("span",{staticClass:"vdr-stick-rotate-line"}),i("span",{staticClass:"vdr-stick vdr-rotate",on:{mousedown:function(e){return e.stopPropagation(),e.preventDefault(),t.rotateDown(e)}}})]:t._e()]:t._e(),i("div",{ref:"slot",staticClass:"vdr-slot"},[t._t("default")],2)],2)},rt=[],st=(i("99af"),i("cb29"),i("4de4"),i("caad"),i("2532"),i("466d"),i("2909")),ct=i("3835"),lt=i("b85c"),ht=(i("96cf"),i("1da1")),ut={},dt={},pt={},ft={name:"pdDragResizeRotate",props:{snap:{type:Boolean,default:!0},snapTolerance:{type:Number,default:5,validator:function(t){return"number"===typeof t}},hidden:{type:Boolean,default:!1},lock:{type:Boolean,default:!1},w:{type:Number,default:100,validator:function(t){return t>=0}},h:{type:Number,default:100,validator:function(t){return t>=0}},x:{type:Number,default:0,validator:function(t){return"number"===typeof t}},y:{type:Number,default:0,validator:function(t){return"number"===typeof t}},z:{type:[String,Number],default:"auto"},r:{type:Number,default:0},sticks:{type:Array,default:function(){return["tl","tm","tr","mr","br","bm","bl","ml","angle"]}},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizeable:{type:Boolean,default:!0},rotateable:{type:Boolean,default:!0},activeable:{type:Boolean,default:!0},widthRange:{type:Array},heightRange:{type:Array}},data:function(){return{whRatio:0,width:this.w,height:this.h,zIndex:this.z,left:this.x,top:this.y,bottom:0,right:0,rotate:this.r,activeStick:-1,currentStick:"",moving:!1}},computed:{style:function(){var t="rotateZ(".concat(Math.round(this.rotate),"deg)"),e="translate3d(".concat(this.left,"px,").concat(this.top,"px,0)");return{zIndex:this.moving?99999:this.zIndex,width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"".concat(e," ").concat(t),visibility:this.hidden?"hidden":"visible"}},rotateSticks:function(){return this.sticks.filter((function(t){return"angle"!==t}))},posData:function(){return{left:this.left,top:this.top,width:this.width,height:this.height,rotate:Math.round(this.rotate),stick:this.currentStick}},minOffsetLeft:function(){return this.parentWidth-this.right-this.minWidth},maxOffsetLeft:function(){return this.parentWidth-this.right-this.maxWidth},minOffsetTop:function(){return this.parentHeight-this.bottom-this.minHeight},maxOffsetTop:function(){return this.parentHeight-this.bottom-this.maxHeight}},mounted:function(){this.init()},beforeDestroy:function(){document.documentElement.removeEventListener("mousemove",this.move),document.documentElement.removeEventListener("mouseup",this.up)},methods:{calcMinWidth:function(){var t=Math.min.apply(null,this.widthRange);return t<0||t>=0&&t>=this.width?0:t||0},calcMaxWidth:function(){var t=Math.max.apply(null,this.widthRange);return t<=0||t>0&&t<this.width?1/0:t||1/0},calcMinHeight:function(){var t=Math.min.apply(null,this.heightRange);if((t<0||t>=0&&t>=this.height)&&(t=0),this.lock){if(this.widthRange)return this.minWidth/this.whRatio;null==this.widthRange&&this.heightRange&&(this.minWidth=t*this.whRatio)}return t||0},calcMaxHeight:function(){var t=Math.max.apply(null,this.heightRange);if((t<=0||t>0&&t<this.height)&&(t=1/0),this.lock){if(this.widthRange)return this.maxWidth/this.whRatio;null==this.widthRange&&this.heightRange&&(this.maxWidth=t*this.whRatio)}return t||1/0},setLimitValue:function(){this.minWidth=this.calcMinWidth(),this.maxWidth=this.calcMaxWidth(),this.minHeight=this.calcMinHeight(),this.maxHeight=this.calcMaxHeight()},getParentsRotate:function(t){var e=0,i=t.path||t.composedPath&&t.composedPath()||[];i=i.filter((function(t){return t.className&&null==t.className.match("vdr-slot")}));var n=i.length||0;if(n<1)return 0;for(var a=n-1;a>0;a--){var o=i[a];o!==window&&o!==document&&(e+=this.getElementRotate(o))}return e},getElementRotate:function(t){if(null==t)return 0;var e=window.getComputedStyle(t,null),i=e["-webkit-transform"]||e["-moz-transform"]||e["-ms-transform"]||e["-o-transform"]||e["transform"];if(null==i.match("matrix"))return 0;var n=i.replace(/matrix\(|\)|\s/gi,""),a=n.split(",")||[],o=Number(a[0]),r=Number(a[1]),s=Math.round(Math.atan2(r,o)*(180/Math.PI));return s||0},init:function(){this.whRatio=this.width/this.height,this.parentElement=this.$el.parentNode,this.parentWidth=this.parentElement.clientWidth,this.parentHeight=this.parentElement.clientHeight,this.bottom=this.parentHeight-this.height-this.top,this.right=this.parentWidth-this.width-this.left,this.setLimitValue(),this.bodyStartPos={mx:0,my:0,left:0,top:0,right:0,bottom:0},document.documentElement.addEventListener("mousemove",this.move),document.documentElement.addEventListener("mouseup",this.up)},bodyDown:function(t){this.activeable&&(t.stopPropagation(),this.bodyDrag=!0,this.currentStick="",this.bodyStartPos.mx=t.clientX,this.bodyStartPos.my=t.clientY,this.bodyStartPos.left=this.left,this.bodyStartPos.top=this.top,this.parentsRotate=this.getParentsRotate(t),this.activeable&&(this.$emit("activated",t,this.posData),this.$emit("dragStart",this.posData),this.createVdrs()))},bodyMove:function(t){var e=this;return Object(ht["a"])(regeneratorRuntime.mark((function i(){var n,a,o,r,s,c,l,h,u;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.moving=!0,n=e.bodyStartPos,a=n.mx,o=n.my,r=n.left,s=n.top,c={x:t.clientX-a,y:t.clientY-o},l=e.parentsRotate*(Math.PI/180),h=c.x*Math.cos(l)+c.y*Math.sin(l),u=c.y*Math.cos(l)-c.x*Math.sin(l),e.left=r+h,e.top=s+u,i.next=10,e.snapCheck();case 10:e.$emit("dragging",e.posData);case 11:case"end":return i.stop()}}),i)})))()},stickDown:function(t,e,i){this.activeable&&(this.stickDrag=!0,this.activeStick=i,this.currentStick=e,this.bodyStartPos.mx=t.clientX,this.bodyStartPos.my=t.clientY,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.bodyStartPos.left=this.left,this.bodyStartPos.top=this.top,this.bodyStartPos.bottom=this.bottom,this.bodyStartPos.right=this.right,this.$emit("resizeStart",this.posData))},stickMove:function(t){var e=this.currentStick,i=this.bodyStartPos,n=i.mx,a=i.my,o=i.top,r=i.left,s=i.bottom,c=i.right,l={x:t.clientX-n,y:t.clientY-a};this.lock&&!e.match("m")&&(e="".concat(e[0],"m"));var h=this.rotate*(Math.PI/180),u=l.x*Math.cos(h)+l.y*Math.sin(h),d=l.y*Math.cos(h)-l.x*Math.sin(h);"t"==e[0]&&(this.top=o+d),"b"==e[0]&&(this.bottom=s-d),"l"==e[1]&&(this.left=r+u),"r"==e[1]&&(this.right=c-u),this.$emit("resizing",this.posData)},rotateDown:function(t){if(this.activeable){var e=this.$refs.vdr,i=e.getBoundingClientRect(),n=i.left,a=i.top,o=i.width,r=i.height;this.rotateDrag=!0,this.currentStick="angle",dt={X:t.clientX,Y:t.clientY},ut={X:n+o/2,Y:a+r/2},this.$emit("rotateStart",this.posData)}},rotateMove:function(t){pt={X:t.clientX,Y:t.clientY};var e={X:dt.X-ut.X,Y:dt.Y-ut.Y},i={X:pt.X-ut.X,Y:pt.Y-ut.Y},n=e.X*i.Y-e.Y*i.X,a=ut.X-dt.X,o=ut.X-pt.X,r=ut.Y-dt.Y,s=ut.Y-pt.Y,c=Math.sqrt(a*a+r*r),l=Math.sqrt(o*o+s*s),h=e.X*i.X+e.Y*i.Y,u=Math.acos(h/(c*l)),d=u/Math.PI*180||0;this.rotate=n<0?this.rotate-d:this.rotate+d,this.$emit("rotating",this.posData),dt={X:t.clientX,Y:t.clientY}},move:function(t){this.draggable&&this.bodyDrag&&this.bodyMove(t),this.resizeable&&this.stickDrag&&this.stickMove(t),this.rotateable&&this.rotateDrag&&this.rotateMove(t)},up:function(){if(this.moving=!1,this.draggable&&this.bodyDrag){this.bodyDrag=!1,this.width>0&&this.height>0&&(this.whRatio=this.width/this.height);var t=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),e={vLine:[],hLine:[]};for(var i in e)e[i]=JSON.parse(JSON.stringify(t));this.$emit("refLineParams",e),this.removeVdrs(),this.$emit("dragStop",this.posData)}this.resizeable&&this.stickDrag&&(this.stickDrag=!1,this.$emit("resizeStop",this.posData)),this.rotateable&&this.rotateDrag&&(this.rotateDrag=!1,this.$emit("rotateStop",this.posData))},snapCheck:function(){var t=this;return Object(ht["a"])(regeneratorRuntime.mark((function e(){var i,n,a,o,r,s,c,l,h,u,d,p,f,m,v,g,y,b,k,x,w,S,M,$,L,O,I,N,D,E,C,T,P,R,z,_,A,j,H,X,Y,W,B,F,J;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.width,n=t.height,!t.snap){e.next=24;break}for(h in a=t.left,o=t.left+i,r=t.top,s=t.top+n,c=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),l={vLine:[],hLine:[]},l)l[h]=JSON.parse(JSON.stringify(c));return u=t.$el.parentNode.childNodes,d={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},e.next=14,t.getActiveAll(u);case 14:p=e.sent,f=p.groupWidth,m=p.groupHeight,v=p.groupLeft,g=p.groupTop,y=p.bln,y||(i=f,n=m,a=v,o=v+f,r=g,s=g+m),b=Object(lt["a"])(u);try{for(b.s();!(k=b.n()).done;)if(x=k.value,void 0!==x.className&&!x.className.includes("vdr-active")&&x.className.includes("vdr"))for(w=x.offsetWidth,S=x.offsetHeight,M=t.formatTransformVal(x),$=Object(ct["a"])(M,2),L=$[0],O=$[1],I=L+w,N=O+S,D=Math.abs(r+n/2-(O+S/2))<=t.snapTolerance,E=Math.abs(a+i/2-(L+w/2))<=t.snapTolerance,C=Math.abs(O-s)<=t.snapTolerance,T=Math.abs(N-s)<=t.snapTolerance,P=Math.abs(O-r)<=t.snapTolerance,R=Math.abs(N-r)<=t.snapTolerance,z=Math.abs(L-o)<=t.snapTolerance,_=Math.abs(I-o)<=t.snapTolerance,A=Math.abs(L-a)<=t.snapTolerance,j=Math.abs(I-a)<=t.snapTolerance,d["display"]=[C,T,P,R,D,D,z,_,A,j,E,E],d["position"]=[O,N,O,N,O+S/2,O+S/2,L,I,L,I,L+w/2,L+w/2],C&&(y&&(t.top=O-n,t.bottom=t.parentHeight-t.top-n),d.value.y[0].push(L,I,a,o)),P&&(y&&(t.top=O,t.bottom=t.parentHeight-t.top-n),d.value.y[0].push(L,I,a,o)),T&&(y&&(t.top=N-n,t.bottom=t.parentHeight-t.top-n),d.value.y[1].push(L,I,a,o)),R&&(y&&(t.top=N,t.bottom=t.parentHeight-t.top-n),d.value.y[1].push(L,I,a,o)),z&&(y&&(t.left=L-i,t.right=t.parentWidth-t.left-i),d.value.x[0].push(O,N,r,s)),A&&(y&&(t.left=L,t.right=t.parentWidth-t.left-i),d.value.x[0].push(O,N,r,s)),_&&(y&&(t.left=I-i,t.right=t.parentWidth-t.left-i),d.value.x[1].push(O,N,r,s)),j&&(y&&(t.left=I,t.right=t.parentWidth-t.left-i),d.value.x[1].push(O,N,r,s)),D&&(y&&(t.top=O+S/2-n/2,t.bottom=t.parentHeight-t.top-n),d.value.y[2].push(L,I,a,o)),E&&(y&&(t.left=L+w/2-i/2,t.right=t.parentWidth-t.left-i),d.value.x[2].push(O,N,r,s)),H=[0,1,0,1,2,2,0,1,0,1,2,2],X=0;X<=H.length;X++)Y=X<6?"y":"x",W=X<6?"hLine":"vLine",d.display[X]&&(B=t.calcLineValues(d.value[Y][H[X]]),F=B.origin,J=B.length,l[W][H[X]].display=d.display[X],l[W][H[X]].position=d.position[X]+"px",l[W][H[X]].origin=F,l[W][H[X]].lineLength=J)}catch(G){b.e(G)}finally{b.f()}t.$emit("refLineParams",l);case 24:case"end":return e.stop()}}),e)})))()},calcLineValues:function(t){var e=Math.max.apply(Math,Object(st["a"])(t))-Math.min.apply(Math,Object(st["a"])(t))+"px",i=Math.min.apply(Math,Object(st["a"])(t))+"px";return{length:e,origin:i}},getActiveAll:function(t){var e=this;return Object(ht["a"])(regeneratorRuntime.mark((function i(){var n,a,o,r,s,c,l,h,u,d,p,f,m,v,g,y,b,k,x,w,S;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n=[],a=[],o=[],r=0,s=0,c=0,l=0,h=Object(lt["a"])(t);try{for(h.s();!(u=h.n()).done;)d=u.value,void 0!==d.className&&d.className.includes("vdr-active")&&n.push(d)}catch(M){h.e(M)}finally{h.f()}if(p=n.length,p>1){f=e.parentElement.getBoundingClientRect(),m=Object(lt["a"])(n);try{for(m.s();!(v=m.n()).done;)g=v.value,y=g.getBoundingClientRect(),b=y.left-f.left,k=b+g.offsetWidth,x=y.top-f.top,w=x+g.offsetHeight,a.push(x,w),o.push(b,k)}catch(M){m.e(M)}finally{m.f()}r=Math.max.apply(Math,o)-Math.min.apply(Math,o),s=Math.max.apply(Math,a)-Math.min.apply(Math,a),c=Math.min.apply(Math,o),l=Math.min.apply(Math,a)}return S=1===p,i.abrupt("return",{groupWidth:r,groupHeight:s,groupLeft:c,groupTop:l,bln:S});case 13:case"end":return i.stop()}}),i)})))()},formatTransformVal:function(t){var e=window.getComputedStyle(t),i=e["transform"]||e.webkitTransform||e.mozTransform;if("none"===i)return[0,0,0];var n=i.includes("3d")?"3d":"2d",a=i.match(/matrix.*\((.+)\)/)[1].split(", ");return"2d"===n?[+a[4],+a[5],0]:"3d"===n?[+a[12],+a[+a[14]]]:void 0},createVdrs:function(){var t=this,e=document.querySelector(".item-box"),i=e.querySelectorAll(".vdr"),n=[].filter.call(i,(function(e){return t.$el.parentNode!==e.parentNode&&!e.classList.contains("dragdropbox")}));n.unshift(e),this.vdrs=[];for(var a=this.$el.parentNode.getBoundingClientRect(),o=0;o<n.length;++o){var r=n[o],s=r.getBoundingClientRect(),c=s.left-a.left,l=s.top-a.top,h=s.width,u=s.height,d=document.createElement("div");d.className="vdr static",d.style.transform="translate3d(".concat(c,"px,").concat(l,"px,0)"),d.style.height=u+"px",d.style.width=h+"px",this.$el.parentNode.prepend(d),this.vdrs.push(d)}},removeVdrs:function(){this.vdrs&&this.vdrs.forEach((function(t){t.remove()}))}},watch:{left:function(t){this.bodyDrag||(t>this.minOffsetLeft&&(this.left=this.minOffsetLeft),t<this.maxOffsetLeft&&(this.left=this.maxOffsetLeft),this.width=this.parentWidth-this.left-this.right,this.lock&&(this.height=this.width/this.whRatio))},top:function(t){this.bodyDrag||(t>this.minOffsetTop&&(this.top=this.minOffsetTop),t<this.maxOffsetTop&&(this.top=this.maxOffsetTop),this.height=this.parentHeight-this.top-this.bottom,this.lock&&(this.width=this.height*this.whRatio,this.currentStick.match("l")&&(this.left=this.parentWidth-this.right-this.width)))},right:function(t){if(!this.bodyDrag){var e=this.parentWidth-t-this.left;e=e<this.minWidth?this.minWidth:e,e=e>this.maxWidth?this.maxWidth:e,this.width=e,this.lock&&(this.height=this.width/this.whRatio)}},bottom:function(t){if(!this.bodyDrag){var e=this.parentHeight-t-this.top;e=e<this.minHeight?this.minHeight:e,e=e>this.maxHeight?this.maxHeight:e,this.height=e,this.lock&&(this.width=this.height*this.whRatio,this.currentStick.match("l")&&(this.left=this.parentWidth-this.right-this.width))}},w:function(t){if(t<=0||isNaN(t)||null==t)return this.width=0,void(this.height=0);this.width=t,this.lock&&(this.height=Math.round(t/(this.w/this.h))),this.whRatio=this.width/this.height},h:function(t){if(t<=0||isNaN(t)||null==t)return this.width=0,void(this.height=0);this.height=t,this.lock&&(this.width=Math.round(t*(this.w/this.h))),this.whRatio=this.width/this.height},x:function(t){this.left=t,this.right=this.parentWidth-this.w-t},y:function(t){this.top=t,this.bottom=this.parentHeight-this.h-t},z:function(t){this.zIndex=t},r:function(t){this.rotate=t},lock:function(t){t&&(this.whRatio=this.width/this.height,this.setLimitValue())}}},mt=ft,vt=(i("b0be"),Object(c["a"])(mt,ot,rt,!1,null,null,null)),gt=vt.exports,yt={name:"resizeable",components:{pdDragResizeRotate:gt,dragdropbox:at},props:{element:{type:Object,default:function(){return null}},zIndex:{type:Number,default:0},activeable:{type:Boolean,default:!0},ShiftKey:{type:Boolean,default:!1}},computed:{selected:function(){return tt.selected},scale:function(){return tt.ruleConfig?tt.ruleConfig.scale:1},isLock:function(){return this.ShiftKey}},data:function(){return{orPos:{},diffPos:{left:0,top:0},vLine:[],hLine:[],sticks:["tl","tm","tr","mr","ml","bl","bm","br","angle"]}},methods:{getRefLineParams:function(t){var e=t.vLine,i=t.hLine,n=0;this.vLine=e.map((function(t){return t["id"]=++n,t})),this.hLine=i.map((function(t){return t["id"]=++n,t}))},select:function(t){tt.$emit("select",t)},unSelect:function(t){tt.$emit("unSelect",t)},cleanSelect:function(t){console.log("cleanSelect"),tt.$emit("cleanSelect",t)},dragStart:function(t){var e=this;this.selected.forEach((function(t){e.orPos[t.id]={top:t.top,left:t.left}})),this.diffPos={left:t.left,top:t.top},tt.$emit("recordShot")},dragging:function(t){var e=this,i=t.top,n=t.left;if(this.selected.length>1){var a=i-this.diffPos.top,o=n-this.diffPos.left;this.selected.forEach((function(t){if(t.id!==e.element.id){var i=e.orPos[t.id].left+e.px2mm(o),n=e.orPos[t.id].top+e.px2mm(a);tt.$emit("updateItem",{id:t.id,data:{left:i,top:n},updateGroupBox:!1})}}))}},dragStop:function(t){if(1===this.selected.length){var e=t.left,i=t.top,n=t.width,a=t.height,o=t.rotate;e=this.px2mm(e),i=this.px2mm(i),n=this.px2mm(n),a=this.px2mm(a),tt.$emit("updateItem",{id:this.element.id,data:{left:e,top:i,width:n,height:a,rotate:o},updateGroupBox:!0})}else{var r=t.left,s=t.top,c=t.width,l=t.height,h=t.rotate;r=this.px2mm(r),s=this.px2mm(s),c=this.px2mm(c),l=this.px2mm(l),tt.$emit("updateItem",{id:this.element.id,data:{left:r,top:s,width:c,height:l,rotate:h},updateGroupBox:!1}),tt.$emit("updateGroup")}},resizeStart:function(){tt.$emit("recordShot")},resizeStop:function(t){var e=t.left,i=t.top,n=t.width,a=t.height,o=t.rotate;e=this.px2mm(e),i=this.px2mm(i),n=this.px2mm(n),a=this.px2mm(a),tt.$emit("updateSelected",{left:e,top:i,width:n,height:a,rotate:o}),tt.$emit("updateGroup")},rotateStart:function(){tt.$emit("recordShot")},rotateStop:function(t){var e=t.left,i=t.top,n=t.width,a=t.height,o=t.rotate;e=this.px2mm(e),i=this.px2mm(i),n=this.px2mm(n),a=this.px2mm(a),tt.$emit("updateSelected",{left:e,top:i,width:n,height:a,rotate:o}),tt.$emit("updateGroup")},beforeSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.element;this.activeable?this.select({event:t,id:e.id}):this.$emit("parentSelect",t,e)},parentActiveChild:function(){this.activeable?this.element.children.length&&this.element.active&&(R(this.selected)&&this.selected.length>1?(this.cleanSelect(),this.select({id:this.element.id})):this.element.childActiveAble=!0):this.$emit("parentActiveChild")},draggable:function(t){return this.selected.findIndex((function(e){return e.id===t}))>-1},resizeable:function(t){var e=t.id;return"dragdropbox"!=t.type&&(!(this.selected.length>1)&&this.selected.findIndex((function(t){return t.id===e}))>-1)},rotateable:function(t){t.id;return!1},setDragDropBoxClass:function(){return"dragdropbox"==this.element.type&&this.element.active&&!this.element.childActiveAble?"box-active dragdropbox":"dragdropbox"==this.element.type&&this.element.active&&this.element.childActiveAble?"dragdropbox":"dragdropbox"!=this.element.type||this.element.active?"":"noborder dragdropbox"},mm2px:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return parseFloat((Number(t)*this.scale).toFixed(1))},px2mm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return parseFloat((Number(t)/this.scale).toFixed(1))}}},bt=yt,kt=(i("ac4c"),Object(c["a"])(bt,I,N,!1,null,"ddd2e696",null)),xt=kt.exports,wt=i("f6f1"),St=i.n(wt),Mt=(i("45fc"),i("e25e"),function(t){this.api=this.builder(),this.api.constructRulers.call(this,t)});Mt.prototype.builder=function(){var t,e=1,i=2,n=0,a=0,o=1,r={},s=[],c=document.createElement("div"),l=[],h={rulerHeight:15,fontFamily:"arial",fontSize:"8px",strokeStyle:"gray",sides:["top","left"],cornerSides:["TL"],lineWidth:1,enableMouseTracking:!0,enableToolTip:!0},u=function(t,e){var i="rotate("+e+"deg)",n=Mt.prototype.utils.pixelize(Math.abs(parseInt(t.canvas.style.left)))+" 100%";t.canvas.style.webkitTransform=i,t.canvas.style.MozTransform=i,t.canvas.style.OTransform=i,t.canvas.style.msTransform=i,t.canvas.style.transform=i,t.canvas.style.webkitTransformOrigin=n,t.canvas.style.MozTransformOrigin=n,t.canvas.style.OTransformOrigin=n,t.canvas.style.msTransformOrigin=n,t.canvas.style.transformOrigin=n},d=function(t,e){switch(t.canvas.style.left=Mt.prototype.utils.pixelize(-(t.canvas.width/2-t.canvas.height)),e){case"top":t.orgPos=parseInt(t.canvas.style.left);break;case"left":t.canvas.style.top=Mt.prototype.utils.pixelize(-t.canvas.height-1),t.orgPos=parseInt(t.canvas.style.top),u(t,90);break}},p=function(t,e){var i=function(t){t.preventDefault(),t.stopPropagation(),f(e.dimension,t.clientX,t.clientY,t)};e.canvas.addEventListener("mousedown",i),e.clearListeners=function(){e.canvas.removeEventListener("mousedown",i)}},f=function(i,r,l,h,u){var d,p=function(i,n,a){var o=i.dimension===e?n:a;i.assigned()?o<t.rulerHeight&&(s.some((function(t,e){if(t.line===i)return d=e,!0})),i.destroy(),s.splice(d,1)):o>t.rulerHeight&&i.assigned(!0)},f=document.createElement("div"),m=i===e?"rul_lineVer":"rul_lineHor",v=i===e?n:a;f.title="双击删除",Mt.prototype.utils.addClasss(f,["rul_line",m]),f=c.appendChild(f),i===e?(f.style.left=Mt.prototype.utils.pixelize(r-t.container.getBoundingClientRect().left),u&&(f.style.left=Mt.prototype.utils.pixelize(Math.round(r/o)+t.rulerHeight))):(f.style.top=Mt.prototype.utils.pixelize(l-t.container.getBoundingClientRect().top),u&&(f.style.top=Mt.prototype.utils.pixelize(Math.round(l/o)+t.rulerHeight))),s.push({dimension:i,line:Mt.prototype.guideLine(f,t.container.querySelector(".rul_wrapper"),i,t,v,p,h)})},m=function(n,a){var o,s="left"===a||"right"===a?e:i,c=s===e?"rul_ruler_Vertical":"rul_ruler_Horizontal",l=document.createElement("canvas");Mt.prototype.utils.addClasss(l,["rul_ruler",c,"rul_align_"+a]),o=n.appendChild(l),r[a]=Mt.prototype.rulerConstructor(o,t,s),r[a].drawRuler(n,t.rulerHeight),d(r[a],a),p(n,r[a])},v=function(){function e(e,i){var n=document.createElement("div"),a="rul_corner"+i.toUpperCase();n.title="点击 清除辅助线",Mt.prototype.utils.addClasss(n,["rul_corner",a]),n.style.width=Mt.prototype.utils.pixelize(t.rulerHeight+1),n.style.height=Mt.prototype.utils.pixelize(t.rulerHeight);var o=e.appendChild(n),r=document.createElement("div");r.style.position="absolute",r.style.height=Mt.prototype.utils.pixelize(t.rulerHeight),r.style.left=0,r.style.right=0,r.style.background="#fff",e.appendChild(r);var s=document.createElement("div");return s.style.position="absolute",s.style.width=Mt.prototype.utils.pixelize(t.rulerHeight),s.style.top=0,s.style.bottom=0,s.style.background="#fff",e.appendChild(s),o}function i(t){t.stopPropagation(),t.preventDefault(),w()}return function(t,n){n.forEach((function(n){var a=e(t,n);a.addEventListener("mousedown",i),a.destroy=function(){a.removeEventListener("mousedown",i),a.parentNode.removeChild(a)},l.push(a)}))}}(),g=function(t){s.forEach((function(t){t.line.stopDrag()}))},y=function(e){c=Mt.prototype.utils.addClasss(c,"rul_wrapper"),t=Mt.prototype.utils.extend(h,e),c=t.container.appendChild(c),t.sides.forEach((function(t){m(c,t)})),v(c,t.cornerSides),t.container.addEventListener("mouseup",g)},b=function(t){var e=0;for(var i in r)r.hasOwnProperty(i)&&t(r[i],e++)},k=function(t){var o,r=0,c=0,l=0;b((function(i){i.dimension===e?(o=i.canvas.style.top,i.canvas.style.top=Mt.prototype.utils.pixelize(i.orgPos+parseInt(t.y)),l=parseInt(o)-parseInt(i.canvas.style.top)):(r=i.canvas.style.left,i.canvas.style.left=Mt.prototype.utils.pixelize(i.orgPos+parseInt(t.x)),c=parseInt(r)-parseInt(i.canvas.style.left))})),s.forEach((function(e){e.dimension===i?(e.line.guideLine.style.top=Mt.prototype.utils.pixelize(parseInt(e.line.guideLine.style.top)-l),e.line.curPosDelta(parseInt(t.y))):(e.line.guideLine.style.left=Mt.prototype.utils.pixelize(parseInt(e.line.guideLine.style.left)-c),e.line.curPosDelta(parseInt(t.x)))})),n=parseInt(t.x),a=parseInt(t.y)},x=function(e){var r,c,l;b((function(t){t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.context.beginPath(),t.setScale(e),t.context.stroke(),o=e})),s.forEach((function(o){o.dimension===i?(r=parseInt(o.line.guideLine.style.top),c=t.rulerHeight+1,l=parseFloat(e)/o.line.curScale(),o.line.guideLine.style.top=Mt.prototype.utils.pixelize((r-c-a)/l+c+a),o.line.curScale(e)):(r=parseInt(o.line.guideLine.style.left),c=t.rulerHeight+1,l=parseFloat(e)/o.line.curScale(),o.line.guideLine.style.left=Mt.prototype.utils.pixelize((r-c-n)/l+c+n),o.line.curScale(e))}))},w=function(){s.forEach((function(t){t.line.destroy()})),s=[]},S=function(t){var e=t?"show":"hide";s.forEach((function(t){t.line[e]()}))},M=function(e){var i=e?"block":"none";c.style.display=i;var n=t.container.querySelectorAll(".rul_tracker");n.length>0&&(n[0].style.display=i,n[1].style.display=i)},$=function(){return s.map((function(e){return{posX:Math.round((parseInt(e.line.guideLine.style.left)-n-t.rulerHeight)*o),posY:Math.round((parseInt(e.line.guideLine.style.top)-a-t.rulerHeight)*o),dimension:e.dimension}}))},L=function(t){t&&t.forEach((function(t){f(t.dimension,t.posX,t.posY,null,!0)}))},O=function(){w(),b((function(t){t.destroy()})),l.forEach((function(t){t.destroy()})),t.container.removeEventListener("mouseup",g),c.parentNode.removeChild(c)};return{VERTICAL:e,HORIZONTAL:i,setPos:k,setScale:x,clearGuides:w,getGuides:$,setGuides:L,constructRulers:y,toggleRulerVisibility:M,toggleGuideVisibility:S,destroy:O}},Mt.prototype.rulerConstructor=function(t,e,i){var n=t,a=n.getContext("2d"),o=0,r=0,s=1,c=i||2,l=0,h=document.createElement("div"),u=function(){return r},d=function(){return o},p=function(){return s},f=function(t){return s=parseFloat(t),v(),s},m=function(t,i,c){t,r=n.width=12e3,o=n.height=i,s=c||s,a.fillStyle="#fff",a.fillRect(0,0,r,o),a.strokeStyle=e.strokeStyle,a.font=e.fontSize+" "+e.fontFamily,a.lineWidth=e.lineWidth,a.beginPath(),a.fillStyle="#000",v(),a.stroke()},v=function(){for(var t=0,e="",i=0,n=!1,c=0,l=o/2,h=parseFloat((1/s).toFixed(2)),u=0;u<=r;u+=h)i=r/2-u,n=!1,e=Math.round(-i*s),e%20===0?(t=c,n=!0):e%10===0&&(e="",t=l,n=!0),n&&(a.moveTo(u+.5,o+.5),a.lineTo(u+.5,t+.5),a.fillText(e,u+1.5,o/2+1))},g=function(t){var i=t.clientX,n=t.clientY;t.preventDefault(),2===c?h.style.left=Mt.prototype.utils.pixelize(i-parseInt(e.container.getBoundingClientRect().left)):h.style.top=Mt.prototype.utils.pixelize(n-parseInt(e.container.getBoundingClientRect().top))},y=function(){e.container.removeEventListener("mousemove",g),h.parentNode.removeChild(h),this.clearListeners&&this.clearListeners()},b=function(){h=e.container.appendChild(h),Mt.prototype.utils.addClasss(h,"rul_tracker");var t=Mt.prototype.utils.pixelize(e.rulerHeight);2===c?(h.style.height=t,h.style.top=0,h.style.bottom=0):(h.style.width=t,h.style.right=0,h.style.left=0),e.container.addEventListener("mousemove",g)};return e.enableMouseTracking&&b(),{getLength:u,getThickness:d,getScale:p,setScale:f,dimension:c,orgPos:l,canvas:n,context:a,drawRuler:m,drawPoints:v,destroy:y}},Mt.prototype.guideLine=function(t,e,i,n,a,o,r){var s,c=t,l=1,h=!1,u=a||0,d=e,p=i||2,f=(o=o||function(){},function(t){return"undefined"===typeof t?u:u=t}),m=function(t){return"undefined"===typeof t?h:h=t},v=function(t){return"undefined"===typeof t?l:l=t},g=function(){return{move:function(t,e){c.style.left=Mt.prototype.utils.pixelize(t),c.style.top=Mt.prototype.utils.pixelize(e),b(t,e),o(s,t,e)},startMoving:function(t){Mt.prototype.utils.addClasss(c,["rul_line_dragged"]),t=t||window.event;var e=t?t.clientX:0,i=t?t.clientY:0,a=parseInt(c.style.top||0),o=parseInt(c.style.left||0),r=parseInt(c.offsetWidth),s=parseInt(c.offsetHeight),l=parseInt(d.offsetWidth),h=parseInt(d.offsetHeight),u=2===p?"ns-resize":"ew-resize";n.container.style.cursor=u,c.style.cursor=u;var f=e-o,m=i-a;document.onmousemove=function(t){t=t||window.event;var e=t.clientX,i=t.clientY,n=e-f,a=i-m;n<0&&(n=0),a<0&&(a=0),n+r>l&&(n=l-r),a+s>h&&(a=h-s),g.move(n,a)},y()},stopMoving:function(){n.container.style.cursor=null,c.style.cursor=null,document.onmousemove=function(){},k(),Mt.prototype.utils.removeClasss(c,["rul_line_dragged"])}}}(),y=function(t){n.enableToolTip&&Mt.prototype.utils.addClasss(c,"rul_tooltip")},b=function(t,e){c.dataset.tip=e?"Y: "+Math.round((e-n.rulerHeight-1-u)*l):"X: "+Math.round((t-n.rulerHeight-1-u)*l)},k=function(t){Mt.prototype.utils.removeClasss(c,"rul_tooltip")},x=function(){g.stopMoving(),o=null,c.removeEventListener("mousedown",M),c.removeEventListener("mouseup",$),c.removeEventListener("dblclick",L),c.parentNode&&c.parentNode.removeChild(c)},w=function(){c.style.display="none"},S=function(){c.style.display="block"},M=function(t){t.stopPropagation(),t.preventDefault(),g.startMoving()},$=function(t){g.stopMoving()},L=function(t){t.stopPropagation(),x()};return c.addEventListener("mousedown",M),c.addEventListener("mouseup",$),c.addEventListener("dblclick",L),r&&g.startMoving(r),s={setAsDraggable:g,startDrag:g.startMoving,stopDrag:g.stopMoving,destroy:x,curScale:v,assigned:m,curPosDelta:f,guideLine:c,dimension:p,hide:w,show:S},s},Mt.prototype.utils={extend:function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[t].hasOwnProperty(e)&&(arguments[0][e]=arguments[t][e]);return arguments[0]},pixelize:function(t){return t+"px"},prependChild:function(t,e){return t.insertBefore(e,t.firstChild)},addClasss:function(t,e){return e instanceof Array||(e=[e]),e.forEach((function(e){t.className+=" "+e})),t},removeClasss:function(t,e){var i=t.className;return e instanceof Array||(e=[e]),e.forEach((function(t){i=i.replace(t,"")})),t.className=i,t}};var $t,Lt,Ot=Mt,It=(i("2531"),i("bee2")),Nt={x:0,y:0,scale:1,maxScale:1,minScale:1,moving:!0,speed:.002,origin:"0,0,0"},Dt=function(){function t(e){Object(Y["a"])(this,t),this.$config=Object.assign({},Nt,e);var i=this.$config,n=i.zoomDom,a=i.eventDom;this.zoomDom=n,this.eventDom=a,this.zoomDom.style.transform="matrix(1,0,0,1,0,0)",this.center(),this.matrixTo(),this.lastPos()}return Object(It["a"])(t,[{key:"center",value:function(){this.$config.x=this.eventDom.offsetWidth/2-this.zoomDom.offsetWidth/2,this.$config.y=this.$config.y||30}},{key:"cal",value:function(t){var e=this,i=e.eventDom[0],n=e.$config.x,a=e.$config.y,o=e.$config.scale,r=t.wheelDelta<=0?o-e.$config.speed:o+e.$config.speed,s=Number(parseFloat(r/o).toFixed(2));if(r<=.1)return!1;var c=t.clientX-e.getRect(i).left,l=t.clientY-e.getRect(i).top,h=Number(parseFloat(s*n+(1-s)*c).toFixed(2)),u=Number(parseFloat(s*a+(1-s)*l).toFixed(2));return e.$config.x=h,e.$config.y=u,e.$config.scale=r,e.matrixTo(),e.lastPos(),!0}},{key:"getRect",value:function(t){return t.getBoundingClientRect()}},{key:"zoomIn",value:function(t){this.cal({wheelDelta:0,clientX:this.getRect(this.eventDom).width/2,clientY:this.getRect(this.eventDom).height/2})}},{key:"zoomOut",value:function(t){this.cal({wheelDelta:1,clientX:this.getRect(this.eventDom).width/2,clientY:this.getRect(this.eventDom).height/2})}},{key:"zoom",value:function(t){return this.cal(t)}},{key:"destroy",value:function(){}},{key:"moveTo",value:function(t,e){this.$config.scale=t||this.$config.scale,this.$config.x=e.x?e.x:this.$config.x,this.$config.y=e.y?e.y:this.$config.y,this.matrixTo()}},{key:"move",value:function(t){var e=this;e.canMove&&(e.$config.x=e.$oldPos.x+t.clientX-e.moveStart.clientX,e.$config.y=e.$oldPos.y+t.clientY-e.moveStart.clientY,this.matrixTo(),e.$config.move&&e.$config.move(t))}},{key:"matrixTo",value:function(){var t=this;t.zoomDom.style.transform=$t.getMatrix({x:t.$config.scale,y:t.$config.scale},{x:t.$config.x,y:t.$config.y})}},{key:"addMask",value:function(){var t=this;t.maskLoad||(t.mask||(t.mask=document.createElement("div"),t.mask.style.zIndex=999,t.mask.style.position="absolute",t.mask.style.top=0,t.mask.style.right=0,t.mask.style.left=0,t.mask.style.bottom=0,t.mask.addEventListener("mousedown",(function(e){0===e.button&&(e.stopPropagation(),t.getStartPos(e),t.canMove=!0)}))),t.eventDom.append(t.mask),t.maskLoad=!0)}},{key:"removeMask",value:function(){var t=this;t.mask&&t.mask.remove(),t.maskLoad=!1}},{key:"getStartPos",value:function(t){this.moveStart=t}},{key:"lastPos",value:function(t){var e=this,i=this.zoomDom.style.transform.replace(/^matrix(3d)?\((.*)\)$/,"$2").split(/, /);this.$oldPos={x:parseFloat(i[4],3),y:parseFloat(i[5],3),scale:parseFloat(i[0],3)},e.canMove=!1,t&&e.$config.moveStop&&e.$config.moveStop(t)}}]),t}();function Et(t){"SPACE"==t.code.toUpperCase()&&(Lt.addMask(),t.stopPropagation())}function Ct(){Lt.removeMask()}function Tt(t){Lt.move(t)}function Pt(t){0===t.button&&Lt.lastPos(t)}$t={isIn:function(t,e){var i=e.clientX,n=e.clientY,a=t.offset().left,o=t.offset().top,r=t.offset().left+t.outerWidth(),s=t.offset().top+t.outerHeight();return!(i<a||i>r||n<o||n>s)},getMatrix:function(t,e){var i=1,n=1,a=0,o=0,r=t.x?t.x:1,s=t.y?t.y:1,c=e.x?e.x:0,l=e.y?e.y:0;return r=Number(r),s=Number(s),c=Number(c),l=Number(l),isNaN(r)||isNaN(s)||isNaN(c)||isNaN(l)?(console.warn("isNaN with scale"),"matrix(1,0,0,1,0,0)"):"matrix("+r*i+",0,0,"+s*n+","+(a+c)+","+(o+l)+")"}};var Rt={bind:function(){},inserted:function(t,e){var i=15;t.ruler=new Ot({container:t,rulerHeight:i,fontFamily:"arial",fontSize:"10px",strokeStyle:"black",lineWidth:1,enableMouseTracking:!0,enableToolTip:!1}),t.ruler.api.setScale(parseFloat(1/e.value)||1),Lt=t.panmove=new Dt({zoomDom:t.querySelector(".layer-box"),eventDom:t,moveStop:function(){t.ruler.api.setPos({x:t.panmove.$config.x-i,y:t.panmove.$config.y-i})},move:function(e){t.ruler.api.setPos({x:t.panmove.$config.x-i,y:t.panmove.$config.y-i})}}),tt.$on("initTree",(function(){tt.$nextTick((function(){Lt.center(),Lt.matrixTo(),Lt.lastPos(),t.ruler.api.setPos({x:t.panmove.$config.x-i,y:t.panmove.$config.y-i})}))})),t.ruler.api.setPos({x:t.panmove.$config.x-i,y:t.panmove.$config.y-i}),document.body.addEventListener("keydown",Et),document.body.addEventListener("keyup",Ct),document.addEventListener("mousemove",Tt),document.addEventListener("mouseup",Pt),document.addEventListener("mouseout",Pt)},update:function(){},componentUpdated:function(){},unbind:function(){document.body.removeEventListener("keydown",Et),document.body.removeEventListener("keyup",Ct),document.removeEventListener("mousemove",Tt),document.removeEventListener("mouseup",Pt),document.removeEventListener("mouseout",Pt)}},zt=(i("bfe4"),"body"),_t="fit",At=null,jt=!1,Ht=null,Xt={},Yt={left:0,top:0,width:0,height:0},Wt=document.createElement("div");Wt.setAttribute("class","pd-frame-box");var Bt={bind:function(){},inserted:function(t){t.addEventListener("mousedown",Ft),document.addEventListener("mousemove",Jt),document.addEventListener("mouseup",Gt)},update:function(t,e){Ht="function"==typeof e.value.selected?e.value.selected:null,zt=t,At=e.value.excluded||null,_t=e.value.type||_t},componentUpdated:function(){},unbind:function(t){t.removeEventListener("mousedown",Ft),document.removeEventListener("mousemove",Jt)}};function Ft(t){if(0===t.button&&!H(t.target,"vdr")){var e=zt.getBoundingClientRect();A(e,e,"pointer",t)?(Xt={},jt=!0,Yt={left:t.pageX,top:t.pageY,width:0,height:0},Wt.style.left=Yt.left+"px",Wt.style.top=Yt.top+"px",Wt.style.width=Yt.width,Wt.style.height=Yt.height):jt=!1}}function Jt(t){jt&&(jt&&Math.abs(t.pageX-Yt.left)>=10&&(document.body.contains(Wt)||document.body.append(Wt)),X(),t.pageX>=Yt.left&&(Wt.style.width=t.pageX-Yt.left+1+"px"),t.pageX<Yt.left&&(Wt.style.left=t.pageX+"px",Wt.style.width=Yt.left-t.pageX+"px"),t.pageY>=Yt.top&&(Wt.style.height=t.pageY-Yt.top+1+"px"),t.pageY<Yt.top&&(Wt.style.top=t.pageY+"px",Wt.style.height=Yt.top-t.pageY+"px"),At&&At.children.length&&z(Kt,50)())}function Gt(t){jt&&(jt=!1,Wt.remove(),Ht&&Object.keys(Xt).length&&Ht(Xt))}function Kt(){Xt={},At.children.forEach((function(t){t.hasAttribute("pd-id")&&A(t.getBoundingClientRect(),Wt.getBoundingClientRect(),_t)&&(Xt[t.getAttribute("pd-id")]=!0)}))}var Vt={name:"pdDragBase",directives:{hotkey:St.a.directive,pdRuler:Rt,frameselect:Bt},components:{resizeable:xt},mounted:function(){var t=this;this.$emit("listener",tt),tt.$emit("initTree",this.initTree),tt.$on("shift",(function(e){t.ShiftKey=e}))},watch:{initTree:function(){tt.$emit("initTree",this.initTree)}},data:function(){return{vLine:[],hLine:[],ShiftKey:!1}},computed:{selected:function(){return tt.selected},sketchupData:function(){return tt.state.sketchup},getLayerSize:function(){var t=Object.keys(tt.state.sketchup).length>0?tt.state.sketchup:this.initTree;return{width:t.width*this.ruleOpt.scale+"px",height:t.height*this.ruleOpt.scale+"px"}},ruleOpt:function(){return tt.ruleConfig=this.ruleConfig,tt.ruleConfig},keymap:function(){var t=this,e={shift:{keyup:function(t){},keydown:function(e){t.ShiftKey=!t.ShiftKey}},up:function(e){t.move(e,"up")},down:function(e){t.move(e,"down")},left:function(e){t.move(e,"left")},right:function(e){t.move(e,"right")},"ctrl+c":{keyup:this.copyEvt},"ctrl+z":{keyup:this.undo},"ctrl+r":{keydown:function(t){t.stopPropagation(),t.preventDefault()},keyup:this.redo},"ctrl+v":this.pasteEvt,"ctrl+g":this.group,"ctrl+shift+g":this.breakGroup},i={};return i=/Mac OS/.test(navigator.userAgent)?{backspace:this.deleteEvt}:{delete:this.deleteEvt},Object(O["a"])(Object(O["a"])({},e),i)}},props:{beforeCopy:{type:Function,default:function(){return function(t){return t}}},beforeDelete:{type:Function,default:function(){return function(){return!0}}},beforeAdd:{type:Function,default:function(){return null}},initTree:{type:Object,require:!0,default:function(){return{type:"sketchup",width:200,height:100,to:0,left:0,children:[]}}},ruleConfig:{type:Object,default:function(){return{scale:1,frameSelectType:"fit"}}}},methods:{getRefLineParams:function(t){var e=t.vLine,i=t.hLine,n=0;this.vLine=e.map((function(t){return t["id"]=++n,t})),this.hLine=i.map((function(t){return t["id"]=++n,t}))},cleanSelect:function(t){H(t.target,"vdr")||tt.$emit("cleanSelect")},group:function(t){t.preventDefault(),tt.$emit("recordShot"),tt.$emit("group")},breakGroup:function(t){t.preventDefault(),tt.$emit("recordShot"),tt.$emit("breakGroup")},deleteEvt:function(t){"INPUT"!=t.target.tagName&&"TEXTAREA"!=t.target.tagName&&this.selected&&this.beforeDelete(this.selected)&&(tt.$emit("recordShot"),tt.$emit("removeSelected"))},copyEvt:function(){var t=this.selected;if(t){t=JSON.parse(JSON.stringify(t));var e=this.beforeCopy(t);P(e)?e.then((function(t){tt.$emit("copySelected",t)})):tt.$emit("copySelected",e)}},pasteEvt:function(t){tt.$emit("paste")},move:function(t,e){var i=R(this.selected)?this.selected:[this.selected],n=this.$refs.resizeable[0];n&&i&&"INPUT"!=t.target.tagName&&"TEXTAREA"!=t.target.tagName&&(t.preventDefault(),i.forEach((function(t){var i=t.left,n=t.top;"up"==e?n-=1:"down"==e?n+=1:"left"==e?i-=1:"right"==e&&(i+=1),tt.$emit("updateItem",{id:t.id,data:{left:parseFloat(i.toFixed(2)),top:parseFloat(n.toFixed(2))}})})),tt.$emit("move",e))},selectedEvt:function(t){if(Object.keys(t).length)for(var e in tt.$emit("cleanSelect"),t)tt.$emit("select",{event:{ctrlKey:!0},id:e})},selectById:function(t){tt.$emit("select",{event:{ctrlKey:!1},id:t})},undo:function(){tt.$emit("undo")},redo:function(t){},$pureFire:function(t,e){tt.$emit(t,e)},$fire:function(t,e){tt.$emit("recordShot"),tt.$emit(t,e)},$bind:function(t,e){tt.$on(t,e)},$unbind:function(t,e){tt.$off(t,e)}}},qt=Vt,Ut=(i("b3e3"),Object(c["a"])(qt,$,L,!1,null,"961b6428",null)),Zt=Ut.exports,Qt=[Zt],te=function t(e){t.installed||(Qt.map((function(t){e.component(t.name,t)})),"undefined"!==typeof window&&window.Vue&&t(window.Vue))},ee={install:te,components:Qt,pdDragBase:Zt};n["a"].use(ee),n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(h)}}).$mount("#app")},a6ce:function(t,e,i){},ac4c:function(t,e,i){"use strict";i("a6ce")},b0be:function(t,e,i){"use strict";i("f3e3")},b3e3:function(t,e,i){"use strict";i("f05e")},b64f:function(t,e,i){"use strict";i("4250")},bfe4:function(t,e,i){},ca8c:function(t,e,i){"use strict";i("4630")},edac:function(t,e,i){},f05e:function(t,e,i){},f345:function(t,e,i){"use strict";i("edac")},f3e3:function(t,e,i){}});