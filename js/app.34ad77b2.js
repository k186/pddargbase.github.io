(function(t){function e(e){for(var n,s,r=e[0],c=e[1],l=e[2],u=0,d=[];u<r.length;u++)s=r[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==a[c]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},a={app:0},o=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var h=c;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},2531:function(t,e,i){},"2f18":function(t,e,i){},3591:function(t,e,i){},5345:function(t,e,i){"use strict";i("2f18")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create"},[i("div",{staticClass:"btn-box",staticStyle:{width:"200px","overflow-y":"auto","overflow-x":"hidden"}},[i("button",{ref:"initEvt",staticClass:"btn",on:{click:t.initEvt}},[t._v("初始化事件")]),i("button",{ref:"initTreeEvt",staticClass:"btn",on:{click:t.initTreeEvt}},[t._v("初始化画布")]),i("button",{ref:"add",staticClass:"btn",on:{click:t.add}},[t._v("添加到画布")]),i("button",{ref:"add2",staticClass:"btn",on:{click:t.add2}},[t._v("添加到指定父级")]),i("div",[t._v("ZIndex操作")]),i("button",{ref:"bringForward",staticClass:"btn",on:{click:function(e){return t.zMove("bringForward")}}},[t._v("上")]),i("button",{ref:"sendBackward",staticClass:"btn",on:{click:function(e){return t.zMove("sendBackward")}}},[t._v("下")]),i("button",{ref:"bringToFront",staticClass:"btn",on:{click:function(e){return t.zMove("bringToFront")}}},[t._v("顶")]),i("button",{ref:"sendToBack",staticClass:"btn",on:{click:function(e){return t.zMove("sendToBack")}}},[t._v("底")]),i("div",[t._v("位置移动")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.movestep,expression:"movestep"}],attrs:{type:"text"},domProps:{value:t.movestep},on:{input:function(e){e.target.composing||(t.movestep=e.target.value)}}}),i("button",{ref:"up",staticClass:"btn",on:{click:function(e){return t.move("up")}}},[t._v("上")]),i("button",{ref:"down",staticClass:"btn",on:{click:function(e){return t.move("down")}}},[t._v("下")]),i("button",{ref:"left",staticClass:"btn",on:{click:function(e){return t.move("left")}}},[t._v("左")]),i("button",{ref:"right",staticClass:"btn",on:{click:function(e){return t.move("right")}}},[t._v("右")]),i("div",[t._v("数据操作")]),i("button",{ref:"copy",staticClass:"btn",on:{click:t.copy}},[t._v("复制选中项")]),i("button",{ref:"paste",staticClass:"btn",on:{click:t.paste}},[t._v("粘贴")]),i("button",{ref:"undo",staticClass:"btn",on:{click:t.undo}},[t._v("撤销")]),i("button",{ref:"group",staticClass:"btn",on:{click:t.group}},[t._v("编组")]),i("button",{ref:"breakGroup",staticClass:"btn",on:{click:t.breakGroup}},[t._v("打散")]),i("button",{ref:"deleteSelect",staticClass:"btn",on:{click:t.deleteSelect}},[t._v("删除选中")]),i("button",{ref:"scale",staticClass:"btn",on:{click:t.scale}},[t._v("等比缩放")]),i("div",[t._v("画布数据修改")]),i("div",{staticClass:"edit"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.width,expression:"width"}],attrs:{type:"text"},domProps:{value:t.width},on:{input:function(e){e.target.composing||(t.width=e.target.value)}}}),i("button",{ref:"edit",staticClass:"btn",on:{click:t.edit}},[t._v("修改画布尺寸")]),i("button",{ref:"edit",staticClass:"btn",on:{click:t.edit2}},[t._v("edit2")])])]),i("pdDragBase",{ref:"sketch",attrs:{ruleConfig:{frameSelectType:"touch",stackLength:20,scale:1}}},[i("droot",{attrs:{renderData:t.root}})],1),i("div",{staticStyle:{width:"200px"}},[i("input",{attrs:{type:"text"}}),t._v("\n    "+t._s(t.selected)+"\n\n  ")])],1)},o=[],s=(i("d3b7"),{name:"create",data:function(){return{rightMenu:[{type:"xxx",evt:this.rightText}],sketch:{selected:[]},selected:[],width:100,movestep:10,lock:!1,initTree:{type:"sketchup",width:100,height:200,to:0,left:0,children:[]},root:{}}},mounted:function(){},methods:{initEvt:function(){var t=this;this.sketch=this.$refs.sketch,this.sketch.$bind("addend",(function(e){t.sketch.select({id:e[0]})})),document.addEventListener("keyup",(function(e){t.shift&&t.sketch.$pureFire("shift",!1)})),document.addEventListener("keydown",(function(e){e.shiftKey&&(t.shift=!0,t.sketch.$pureFire("shift",!0))})),this.inited=!0},scale:function(){this.lock=!this.lock,this.sketch.lock({isLock:this.lock})},initTreeEvt:function(){this.sketch.initTree({data:this.initTree,snapShot:!1})},zMove:function(t){this.sketch.zIndex({type:t,id:this.selected[0].id})},move:function(t){this.sketch.move({direction:t})},copy:function(){this.sketch.copy()},paste:function(){this.sketch.paste()},undo:function(){this.sketch.undo()},group:function(){this.sketch.group()},breakGroup:function(){this.sketch.breakGroup()},deleteSelect:function(){this.sketch.deleteSelect()},add:function(){this.sketch.addToSketch({item:[{left:148,top:63,rotate:0,width:31,height:38,active:!0,childActiveAble:!1,type:"dtext",children:[],id:"e7c02a03-0142-4af1-a49d-2e09461d1909",parentId:"4d7438ad-fe8c-4356-89f0-b0385c81b811"},{left:58,top:87,width:50,height:50,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"16ddeef0-9c50-477f-8ff7-07d24e7d8920",parentId:"4d7438ad-fe8c-4356-89f0-b0385c81b811",initXY:{}},{left:6,top:3,width:56,height:75,type:"dragdropbox",id:"432cb02c-a9fa-4a48-baa5-0c529636243a",parentId:"4d7438ad-fe8c-4356-89f0-b0385c81b811",initXY:{},active:!1,childActiveAble:!1,children:[{left:0,top:0,width:42,height:43,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"6547406f-103a-4a12-b65f-599a876bb712",parentId:"432cb02c-a9fa-4a48-baa5-0c529636243a",initXY:{}},{left:28,top:57,width:28,height:18,active:!1,childActiveAble:!1,type:"dtext",children:[],id:"25f597b4-955b-439a-9157-38220f46040f",parentId:"432cb02c-a9fa-4a48-baa5-0c529636243a",initXY:{}}]}]})},add2:function(){this.sketch.addToSketch({parent:1===this.selected.length?this.selected[0]:null,item:[{left:10,top:20,width:50,height:50,active:!1,rotateable:!0,childActiveAble:!1,type:"dtext",children:[],id:"4b133596-62ee-4e70-b3ae-bd93a5482fa6",parentId:null,initXY:{}}]})},edit:function(){this.sketch.updateItem({id:this.root.id,data:{customAttribute:{dataSource:"xxxxx",abc:{ef:123},eef:213}}})},edit2:function(){this.sketch.updateItem({id:this.$refs.sketch.sketchupData.id,data:{customAttribute:{eef:1}}})},beforeCopy:function(t){return console.log(t,"beforeCopy"),new Promise((function(e){e(t)}))},beforeDelete:function(t){return console.log(t,"beforeDelete"),!0}},watch:{"sketch.selected":{handler:function(t){this.selected=t},deep:!0},"sketch.sketchupData":function(t){this.root=t}}}),r=s,c=(i("f345"),i("2877")),l=Object(c["a"])(r,a,o,!1,null,null,null),h=l.exports,u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("pdDragResizeRotate",{attrs:{active:"",r:"30"}},[i("pdDragResizeRotate",{attrs:{active:"",r:"20"}})],1)],1)},d=[],p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"vdr",staticClass:"vdr",class:{"vdr-active":t.active&&t.activeable,"vdr-not-active":!t.activeable},style:t.style,on:{mousedown:function(e){return t.bodyDown(e)}}},[t.active&&t.activeable?[t.resizeable?t._l(t.rotateSticks,(function(e,n){return i("span",{key:n,staticClass:"vdr-stick",class:"vdr-stick-"+e,style:{zIndex:t.activeStick==n?10:9},on:{mousedown:function(i){return i.stopPropagation(),i.preventDefault(),t.stickDown(i,e,n)}}})})):t._e(),t.sticks.indexOf("angle")>-1&&t.rotateable?[i("span",{staticClass:"vdr-stick-rotate-line"}),i("span",{staticClass:"vdr-stick vdr-rotate",on:{mousedown:function(e){return e.stopPropagation(),e.preventDefault(),t.rotateDown(e)}}})]:t._e()]:t._e(),i("div",{ref:"slot",staticClass:"vdr-slot"},[t._t("default")],2)],2)},f=[],m=i("2909"),v=i("3835"),g=i("b85c"),y=i("1da1"),b=(i("96cf"),i("a9e3"),i("99af"),i("4de4"),i("ac1f"),i("466d"),i("5319"),i("1276"),i("cb29"),i("caad"),i("2532"),i("159b"),{}),k={},x={},w={name:"pdDragResizeRotate",props:{snap:{type:Boolean,default:!0},snapTolerance:{type:Number,default:5,validator:function(t){return"number"===typeof t}},hidden:{type:Boolean,default:!1},lock:{type:Boolean,default:!1},w:{type:Number,default:100,validator:function(t){return t>=0}},h:{type:Number,default:100,validator:function(t){return t>=0}},x:{type:Number,default:0,validator:function(t){return"number"===typeof t}},y:{type:Number,default:0,validator:function(t){return"number"===typeof t}},z:{type:[String,Number],default:"auto"},r:{type:Number,default:0},sticks:{type:Array,default:function(){return["tl","tm","tr","mr","br","bm","bl","ml","angle"]}},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizeable:{type:Boolean,default:!0},rotateable:{type:Boolean,default:!0},activeable:{type:Boolean,default:!0},widthRange:{type:Array},heightRange:{type:Array},rulerScale:{type:[Number,String],default:1}},data:function(){return{whRatio:0,width:this.w,height:this.h,zIndex:this.z,left:this.x,top:this.y,bottom:0,right:0,rotate:this.r,activeStick:-1,currentStick:"",moving:!1}},computed:{style:function(){var t="rotateZ(".concat(Math.round(this.rotate),"deg)"),e="translate3d(".concat(this.left,"px,").concat(this.top,"px,0)");return{zIndex:this.moving?99999:this.zIndex,width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"".concat(e," ").concat(t),visibility:this.hidden?"hidden":"visible"}},rotateSticks:function(){return this.sticks.filter((function(t){return"angle"!==t}))},posData:function(){return{left:this.left,top:this.top,width:this.width,height:this.height,rotate:Math.round(this.rotate),stick:this.currentStick}},minOffsetLeft:function(){return this.parentWidth-this.right-this.minWidth},maxOffsetLeft:function(){return this.parentWidth-this.right-this.maxWidth},minOffsetTop:function(){return this.parentHeight-this.bottom-this.minHeight},maxOffsetTop:function(){return this.parentHeight-this.bottom-this.maxHeight}},mounted:function(){this.init()},beforeDestroy:function(){document.documentElement.removeEventListener("mousemove",this.move),document.documentElement.removeEventListener("mouseup",this.up)},methods:{getScale:function(){return parseFloat(1/this.rulerScale)},calcMinWidth:function(){var t=Math.min.apply(null,this.widthRange);return t<0||t>=0&&t>=this.width?0:t||0},calcMaxWidth:function(){var t=Math.max.apply(null,this.widthRange);return t<=0||t>0&&t<this.width?1/0:t||1/0},calcMinHeight:function(){var t=Math.min.apply(null,this.heightRange);if((t<0||t>=0&&t>=this.height)&&(t=0),this.lock){if(this.widthRange)return this.minWidth/this.whRatio;null==this.widthRange&&this.heightRange&&(this.minWidth=t*this.whRatio)}return t||0},calcMaxHeight:function(){var t=Math.max.apply(null,this.heightRange);if((t<=0||t>0&&t<this.height)&&(t=1/0),this.lock){if(this.widthRange)return this.maxWidth/this.whRatio;null==this.widthRange&&this.heightRange&&(this.maxWidth=t*this.whRatio)}return t||1/0},setLimitValue:function(){this.minWidth=this.calcMinWidth(),this.maxWidth=this.calcMaxWidth(),this.minHeight=this.calcMinHeight(),this.maxHeight=this.calcMaxHeight()},getParentsRotate:function(t){var e=0,i=t.path||t.composedPath&&t.composedPath()||[];i=i.filter((function(t){return t.className&&null==t.className.match("vdr-slot")}));var n=i.length||0;if(n<1)return 0;for(var a=n-1;a>0;a--){var o=i[a];o!==window&&o!==document&&(o!==this.$el&&(e+=this.getElementRotate(o)))}return e},getElementRotate:function(t){if(null==t)return 0;var e=window.getComputedStyle(t,null),i=e["-webkit-transform"]||e["-moz-transform"]||e["-ms-transform"]||e["-o-transform"]||e["transform"];if(null==i.match("matrix"))return 0;var n=i.replace(/matrix\(|\)|\s/gi,""),a=n.split(",")||[],o=Number(a[0]),s=Number(a[1]),r=Math.round(Math.atan2(s,o)*(180/Math.PI));return r||0},init:function(){this.whRatio=this.width/this.height,this.parentElement=this.$el.parentNode,this.parentWidth=this.parentElement.clientWidth,this.parentHeight=this.parentElement.clientHeight,this.bottom=this.parentHeight-this.height-this.top,this.right=this.parentWidth-this.width-this.left,this.setLimitValue(),this.bodyStartPos={mx:0,my:0,left:0,top:0,right:0,bottom:0},document.documentElement.addEventListener("mousemove",this.move),document.documentElement.addEventListener("mouseup",this.up)},bodyDown:function(t){this.activeable&&(t.stopPropagation(),this.bodyDrag=!0,this.currentStick="",this.bodyStartPos.mx=t.clientX,this.bodyStartPos.my=t.clientY,this.bodyStartPos.left=this.left,this.bodyStartPos.top=this.top,this.parentsRotate=this.getParentsRotate(t),this.activeable&&(this.$emit("activated",t,this.posData),this.$emit("dragStart",this.posData),this.createVdrs()))},bodyMove:function(t){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function i(){var n,a,o,s,r,c,l,h,u,d;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e.moving=!0,n=e.bodyStartPos,a=n.mx,o=n.my,s=n.left,r=n.top,c={x:t.clientX-a,y:t.clientY-o},l=e.parentsRotate*(Math.PI/180),h=c.x*Math.cos(l)+c.y*Math.sin(l),u=c.y*Math.cos(l)-c.x*Math.sin(l),d=e.getScale(),e.left=s+h*d,e.top=r+u*d,!e.snap){i.next=12;break}return i.next=12,e.snapCheck();case 12:e.$emit("dragging",e.posData);case 13:case"end":return i.stop()}}),i)})))()},stickDown:function(t,e,i){this.activeable&&(this.stickDrag=!0,this.activeStick=i,this.currentStick=e,this.bodyStartPos.mx=t.clientX,this.bodyStartPos.my=t.clientY,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.bodyStartPos.left=this.left,this.bodyStartPos.top=this.top,this.bodyStartPos.bottom=this.bottom,this.bodyStartPos.right=this.right,this.$emit("resizeStart",this.posData))},stickMove:function(t){var e=this.currentStick,i=this.bodyStartPos,n=i.mx,a=i.my,o=i.top,s=i.left,r=i.bottom,c=i.right,l={x:t.clientX-n,y:t.clientY-a};this.lock&&!e.match("m")&&(e="".concat(e[0],"m"));var h=this.rotate*(Math.PI/180),u=l.x*Math.cos(h)+l.y*Math.sin(h),d=l.y*Math.cos(h)-l.x*Math.sin(h),p=this.getScale();"t"==e[0]&&(this.top=o+d*p),"b"==e[0]&&(this.bottom=r-d*p),"l"==e[1]&&(this.left=s+u*p),"r"==e[1]&&(this.right=c-u*p),this.$emit("resizing",this.posData)},rotateDown:function(t){if(this.activeable){var e=this.$refs.vdr,i=e.getBoundingClientRect(),n=i.left,a=i.top,o=i.width,s=i.height;this.rotateDrag=!0,this.currentStick="angle",k={X:t.clientX,Y:t.clientY},b={X:n+o/2,Y:a+s/2},this.$emit("rotateStart",this.posData)}},rotateMove:function(t){x={X:t.clientX,Y:t.clientY};var e={X:k.X-b.X,Y:k.Y-b.Y},i={X:x.X-b.X,Y:x.Y-b.Y},n=e.X*i.Y-e.Y*i.X,a=b.X-k.X,o=b.X-x.X,s=b.Y-k.Y,r=b.Y-x.Y,c=Math.sqrt(a*a+s*s),l=Math.sqrt(o*o+r*r),h=e.X*i.X+e.Y*i.Y,u=Math.acos(h/(c*l)),d=u/Math.PI*180||0;this.rotate=n<0?this.rotate-d:this.rotate+d,this.$emit("rotating",this.posData),k={X:t.clientX,Y:t.clientY}},move:function(t){this.draggable&&this.bodyDrag&&this.bodyMove(t),this.resizeable&&this.stickDrag&&this.stickMove(t),this.rotateable&&this.rotateDrag&&this.rotateMove(t)},up:function(){if(this.moving=!1,this.draggable&&this.bodyDrag){this.bodyDrag=!1,this.width>0&&this.height>0&&(this.whRatio=this.width/this.height);var t=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),e={vLine:[],hLine:[]};for(var i in e)e[i]=JSON.parse(JSON.stringify(t));this.$emit("refLineParams",e),this.removeVdrs(),this.$emit("dragStop",this.posData)}this.resizeable&&this.stickDrag&&(this.stickDrag=!1,this.$emit("resizeStop",this.posData)),this.rotateable&&this.rotateDrag&&(this.rotateDrag=!1,this.$emit("rotateStop",this.posData))},snapCheck:function(){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function e(){var i,n,a,o,s,r,c,l,h,u,d,p,f,m,y,b,k,x,w,S,M,$,L,C,I,D,O,N,E,z,T,P,R,_,A,H,j,X,Y,W,F,B,J,G,K;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(h in i=t.width,n=t.height,a=t.left,o=t.left+i,s=t.top,r=t.top+n,c=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),l={vLine:[],hLine:[]},l)l[h]=JSON.parse(JSON.stringify(c));return u=t.$el.parentNode.childNodes,d={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},e.next=13,t.getActiveAll(u);case 13:p=e.sent,f=p.groupWidth,m=p.groupHeight,y=p.groupLeft,b=p.groupTop,k=p.bln,k||(i=f,n=m,a=y,o=y+f,s=b,r=b+m),x=Object(g["a"])(u);try{for(x.s();!(w=x.n()).done;)if(S=w.value,void 0!==S.className&&!S.className.includes("vdr-active")&&S.className.includes("vdr"))for(M=S.offsetWidth,$=S.offsetHeight,L=t.formatTransformVal(S),C=Object(v["a"])(L,2),I=C[0],D=C[1],O=I+M,N=D+$,E=Math.abs(s+n/2-(D+$/2))<=t.snapTolerance,z=Math.abs(a+i/2-(I+M/2))<=t.snapTolerance,T=Math.abs(D-r)<=t.snapTolerance,P=Math.abs(N-r)<=t.snapTolerance,R=Math.abs(D-s)<=t.snapTolerance,_=Math.abs(N-s)<=t.snapTolerance,A=Math.abs(I-o)<=t.snapTolerance,H=Math.abs(O-o)<=t.snapTolerance,j=Math.abs(I-a)<=t.snapTolerance,X=Math.abs(O-a)<=t.snapTolerance,d["display"]=[T,P,R,_,E,E,A,H,j,X,z,z],d["position"]=[D,N,D,N,D+$/2,D+$/2,I,O,I,O,I+M/2,I+M/2],T&&(k&&(t.top=D-n,t.bottom=t.parentHeight-t.top-n),d.value.y[0].push(I,O,a,o)),R&&(k&&(t.top=D,t.bottom=t.parentHeight-t.top-n),d.value.y[0].push(I,O,a,o)),P&&(k&&(t.top=N-n,t.bottom=t.parentHeight-t.top-n),d.value.y[1].push(I,O,a,o)),_&&(k&&(t.top=N,t.bottom=t.parentHeight-t.top-n),d.value.y[1].push(I,O,a,o)),A&&(k&&(t.left=I-i,t.right=t.parentWidth-t.left-i),d.value.x[0].push(D,N,s,r)),j&&(k&&(t.left=I,t.right=t.parentWidth-t.left-i),d.value.x[0].push(D,N,s,r)),H&&(k&&(t.left=O-i,t.right=t.parentWidth-t.left-i),d.value.x[1].push(D,N,s,r)),X&&(k&&(t.left=O,t.right=t.parentWidth-t.left-i),d.value.x[1].push(D,N,s,r)),E&&(k&&(t.top=D+$/2-n/2,t.bottom=t.parentHeight-t.top-n),d.value.y[2].push(I,O,a,o)),z&&(k&&(t.left=I+M/2-i/2,t.right=t.parentWidth-t.left-i),d.value.x[2].push(D,N,s,r)),Y=[0,1,0,1,2,2,0,1,0,1,2,2],W=0;W<=Y.length;W++)F=W<6?"y":"x",B=W<6?"hLine":"vLine",d.display[W]&&(J=t.calcLineValues(d.value[F][Y[W]]),G=J.origin,K=J.length,l[B][Y[W]].display=d.display[W],l[B][Y[W]].position=d.position[W]+"px",l[B][Y[W]].origin=G,l[B][Y[W]].lineLength=K)}catch(V){x.e(V)}finally{x.f()}t.$emit("refLineParams",l);case 23:case"end":return e.stop()}}),e)})))()},calcLineValues:function(t){var e=Math.max.apply(Math,Object(m["a"])(t))-Math.min.apply(Math,Object(m["a"])(t))+"px",i=Math.min.apply(Math,Object(m["a"])(t))+"px";return{length:e,origin:i}},getActiveAll:function(t){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function i(){var n,a,o,s,r,c,l,h,u,d,p,f,m,v,y,b,k,x,w,S,M;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n=[],a=[],o=[],s=0,r=0,c=0,l=0,h=Object(g["a"])(t);try{for(h.s();!(u=h.n()).done;)d=u.value,void 0!==d.className&&d.className.includes("vdr-active")&&n.push(d)}catch($){h.e($)}finally{h.f()}if(p=n.length,p>1){f=e.parentElement.getBoundingClientRect(),m=Object(g["a"])(n);try{for(m.s();!(v=m.n()).done;)y=v.value,b=y.getBoundingClientRect(),k=b.left-f.left,x=k+y.offsetWidth,w=b.top-f.top,S=w+y.offsetHeight,a.push(w,S),o.push(k,x)}catch($){m.e($)}finally{m.f()}s=Math.max.apply(Math,o)-Math.min.apply(Math,o),r=Math.max.apply(Math,a)-Math.min.apply(Math,a),c=Math.min.apply(Math,o),l=Math.min.apply(Math,a)}return M=1===p,i.abrupt("return",{groupWidth:s,groupHeight:r,groupLeft:c,groupTop:l,bln:M});case 13:case"end":return i.stop()}}),i)})))()},formatTransformVal:function(t){var e=window.getComputedStyle(t),i=e["transform"]||e.webkitTransform||e.mozTransform;if("none"===i)return[0,0,0];var n=i.includes("3d")?"3d":"2d",a=i.match(/matrix.*\((.+)\)/)[1].split(", ");return"2d"===n?[+a[4],+a[5],0]:"3d"===n?[+a[12],+a[+a[14]]]:void 0},createVdrs:function(){var t=this,e=document.querySelector(".item-box");if(this.vdrs=[],e){var i=e.querySelectorAll(".vdr"),n=[].filter.call(i,(function(e){return t.$el.parentNode!==e.parentNode&&!e.classList.contains("dragdropbox")}));n.unshift(e);for(var a=this.$el.parentNode.getBoundingClientRect(),o=0;o<n.length;++o){var s=n[o],r=s.getBoundingClientRect(),c=r.left-a.left,l=r.top-a.top,h=r.width,u=r.height,d=document.createElement("div");d.className="vdr static",d.style.transform="translate3d(".concat(c,"px,").concat(l,"px,0)"),d.style.height=u+"px",d.style.width=h+"px",this.$el.parentNode.prepend(d),this.vdrs.push(d)}}},removeVdrs:function(){this.vdrs&&this.vdrs.forEach((function(t){t.remove()}))}},watch:{left:function(t){this.bodyDrag||(t>this.minOffsetLeft&&(this.left=this.minOffsetLeft),t<this.maxOffsetLeft&&(this.left=this.maxOffsetLeft),this.width=this.parentWidth-this.left-this.right,this.lock&&(this.height=this.width/this.whRatio))},top:function(t){this.bodyDrag||(t>this.minOffsetTop&&(this.top=this.minOffsetTop),t<this.maxOffsetTop&&(this.top=this.maxOffsetTop),this.height=this.parentHeight-this.top-this.bottom,this.lock&&(this.width=this.height*this.whRatio,this.currentStick.match("l")&&(this.left=this.parentWidth-this.right-this.width)))},right:function(t){if(!this.bodyDrag){var e=this.parentWidth-t-this.left;e=e<this.minWidth?this.minWidth:e,e=e>this.maxWidth?this.maxWidth:e,this.width=e,this.lock&&(this.height=this.width/this.whRatio)}},bottom:function(t){if(!this.bodyDrag){var e=this.parentHeight-t-this.top;e=e<this.minHeight?this.minHeight:e,e=e>this.maxHeight?this.maxHeight:e,this.height=e,this.lock&&(this.width=this.height*this.whRatio,this.currentStick.match("l")&&(this.left=this.parentWidth-this.right-this.width))}},w:function(t){if(t<=0||isNaN(t)||null==t)return this.width=0,void(this.height=0);this.width=t,this.lock&&(this.height=Math.round(t/(this.w/this.h))),this.whRatio=this.width/this.height},h:function(t){if(t<=0||isNaN(t)||null==t)return this.width=0,void(this.height=0);this.height=t,this.lock&&(this.width=Math.round(t*(this.w/this.h))),this.whRatio=this.width/this.height},x:function(t){this.left=t,this.right=this.parentWidth-this.w-t},y:function(t){this.top=t,this.bottom=this.parentHeight-this.h-t},z:function(t){this.zIndex=t},r:function(t){this.rotate=t},lock:function(t){t&&(this.whRatio=this.width/this.height,this.setLimitValue())}}},S=w,M=(i("b0be"),Object(c["a"])(S,p,f,!1,null,null,null)),$=M.exports,L={name:"roate",components:{pdDragResizeRotate:$},data:function(){return{el:{id:1}}}},C=L,I=Object(c["a"])(C,u,d,!1,null,"1b25e936",null),D=(I.exports,i("d81d"),i("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-text"},[t._v("text")])}),O=[],N={name:"dtext",props:{renderData:{type:Object,required:!0},type:{type:String,default:function(){return"lib"}}}},E=N,z=(i("ca8c"),Object(c["a"])(E,D,O,!1,null,"ad972faa",null)),T=z.exports,P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-root",style:t.renderStyle()},[t._v(t._s(t.renderData))])},R=[],_={name:"droot",props:{renderData:{type:Object,required:!0}},methods:{renderStyle:function(){var t=this.renderData;return{background:t.background}}}},A=_,H=(i("6c16"),Object(c["a"])(A,P,R,!1,null,"31f8df79",null)),j=H.exports,X=[T,j],Y=function t(e){t.installed||(X.map((function(t){e.component(t.name,t)})),"undefined"!==typeof window&&window.Vue&&t(window.Vue))},W={install:Y,components:X},F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"pd-ruler",rawName:"v-pd-ruler",value:t.ruleConfig.scale,expression:"ruleConfig.scale"},{name:"frameselect",rawName:"v-frameselect",value:{excluded:t.$refs.box,selected:t.frameselectEvt,type:t.ruleConfig.frameSelectType},expression:"{excluded:$refs.box,selected:frameselectEvt,type:ruleConfig.frameSelectType}"}],staticClass:"sketch-box",on:{click:function(e){t.cleanSelect({e:e})}}},[i("div",{staticClass:"layer-box"},[i("div",{staticClass:"layer-content",style:t.getLayerSize},[[i("div",{staticClass:"sketch-stage"},[t._t("default")],2)],i("div",{ref:"box",staticClass:"item-box"},[t._l(t.sketchupData.children,(function(e,n){return i("resizeable",{key:e.id,ref:"resizeable",refInFor:!0,attrs:{"z-index":n,element:e,shiftKey:t.shiftKey,scale:t.ruleConfig.scale,rulerScale:t.rulerScale},on:{"update:element":function(t){e=t},refLineParams:t.getRefLineParams}})})),t._l(t.vLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line v-line",style:{left:t.position,top:t.origin,height:t.lineLength}})})),t._l(t.hLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line h-line",style:{top:t.position,left:t.origin,width:t.lineLength}})}))],2)],2)])])},B=[],J=(i("b64b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.element?i("pdDragResizeRotate",{class:t.setDragDropBoxClass(),attrs:{"pd-id":t.element.id,x:t.mm2px(t.element.left),y:t.mm2px(t.element.top),w:t.mm2px(t.element.width),h:t.mm2px(t.element.height),lock:t.isLock,z:t.zIndex,r:t.element.rotate||0,activeable:t.activeable,active:t.element.active,draggable:t.draggable(t.element.id),resizeable:t.resizeable(t.element),rotateable:t.rotateable(t.element),sticks:t.sticks,rulerScale:t.rulerScale},on:{dragStop:t.dragStop,dragStart:t.dragStart,dragging:t.dragging,resizeStart:t.resizeStart,resizeStop:t.resizeStop,rotateStart:t.rotateStart,rotateStop:t.rotateStop,activated:function(e){return t.beforeSelect(e,t.element)},refLineParams:function(e){t.$emit("refLineParams",e)}},nativeOn:{dblclick:function(e){return t.parentActiveChild.apply(null,arguments)}}},[i(t.element.type,{tag:"component",attrs:{renderData:t.element}},[t.element.children.length?[t._l(t.element.children,(function(e,n){return i("resizeable",{key:e.id,attrs:{element:e,zIndex:n,activeable:t.element.childActiveAble,shiftKey:t.shiftKey,scale:t.scale,rulerScale:t.rulerScale},on:{"update:element":function(t){e=t},parentSelect:t.beforeSelect,parentActiveChild:t.parentActiveChild,refLineParams:t.getRefLineParams}})})),t._l(t.vLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line v-line",style:{left:t.position,top:t.origin,height:t.lineLength}})})),t._l(t.hLine,(function(t){return i("span",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"item.display"}],key:t.id,staticClass:"ref-line h-line",style:{top:t.position,left:t.origin,width:t.lineLength}})}))]:t._e()],2)],1):t._e()}),G=[],K=(i("c740"),i("b680"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"drag-drop-box"},[t._t("default")],2)}),V=[],q=i("5530"),U=i("53ca");i("3ca3"),i("ddb0"),i("2b3d"),i("25f0");function Z(){var t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.substr(e.lastIndexOf("/")+1)}function Q(t){return!!t&&("object"===Object(U["a"])(t)||"function"===typeof t)&&"function"===typeof t.then}function tt(t){return"[object Array]"==Object.prototype.toString.call(t)}function et(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=null,n=!0;return function(){for(var a=this,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];if(n)return t.apply(this,s),n=!1;i||(i=setTimeout((function(){clearTimeout(i),i=null,t.apply(a,s)}),e))}}function it(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0,i=0,n=0,a=0,o=!0;if(tt(t))for(var s=0;s<t.length;++s){var r=t[s];if(r){if(void 0===r.left||void 0===r.top||void 0===r.width||void 0===r.height){o=!1;break}var c={mx:r.left,my:r.top};c.mx,c.my;0===s&&(e=r.left,i=r.top),r.left<=e&&(e=r.left),r.top<=i&&(i=r.top);var l=Number(r.left)+Number(r.width);l>=n&&(n=l);var h=Number(r.top)+Number(r.height);h>=a&&(a=h)}}return o?{left:e,top:i,width:n-e,height:a-i}:{left:0,top:0,width:0,height:0}}function nt(t,e,i,n){var a=t.left,o=t.top,s=t.right,r=t.bottom,c=e.left,l=e.top,h=e.right,u=e.bottom;switch(i){case"fit":return c<=a&&s<=h&&l<=o&&r<=u;case"intersect_x":return c<a+(t.right-t.left)/2&&s-(t.right-t.left)/2<h;case"intersect":return c<a+(t.right-t.left)/2&&s-(t.right-t.left)/2<h&&l<o+(t.bottom-t.top)/2&&r-(t.bottom-t.top)/2<u;case"pointer":return at(n.pageY,l,t.bottom-t.top)&&at(n.pageX,c,t.right-t.left);case"touch":return(o>=l&&o<=u||r>=l&&r<=u||o<l&&r>u)&&(a>=c&&a<=h||s>=c&&s<=h||a<c&&s>h);default:return!1}}function at(t,e,i){return t>=e&&t<e+i}function ot(t,e){do{if(t.classList&&t.classList.contains(e))return!0;t=t.parentNode}while(t);return!1}function st(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}var rt=i("d4ec"),ct=(i("a434"),{type:"dragdropbox"});function lt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{id:null};if(e.id=Z(),e.parentId=i.id,e=Object(q["a"])(Object(q["a"])({left:0,top:0,width:50,height:50},e),{},{active:!1,childActiveAble:!1}),e.children&&e.children.length)for(var n=0;n<e.children.length;++n)e.children[n]=lt(t,e.children[n],e);else e.children=[];return t.sketchupMap[e.id]=e,e}function ht(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){t.active=!1,t.childActiveAble=!1;for(var e=0;e<t.children.length;++e)t.children[e]=ht(t.children[e]);return t}}function ut(t,e,i,n,a,o){e.forEach((function(e){t.sketchupMap[e.id].left=t.sketchupMap[e.id].left-o.left,t.sketchupMap[e.id].top=t.sketchupMap[e.id].top-o.top,t.sketchupMap[e.id].parentId=a.id,n.push(t.sketchupMap[e.id]);var s=i.findIndex((function(t){return e.id===t.id}));i.splice(s,1)})),i.push(a)}function dt(t,e,i,n,a){e.children.map((function(e){t.sketchupMap[e.id].parentId=a,t.sketchupMap[e.id].top=t.sketchupMap[e.id].top+n.top,t.sketchupMap[e.id].left=t.sketchupMap[e.id].left+n.left,i.push(t.sketchupMap[e.id])}));var o=i.findIndex((function(t){return t.id===e.id}));i.splice(o,1),delete t.sketchupMap[e.id]}function pt(t,e,i,n){var a=t;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var o=e.split("."),s=0,r=o.length;s<r-1;++s){var c=o[s];c in a&&(a=a[c])}if(i&&i.constructor===Object)for(var l in i){var h=i[l];n.$set(a,o[s],a[o[s]]||{}),pt(a[o[s]],l,h,n)}else n.$set(a,o[s],i)}function ft(t,e,i){var n=t;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var a=e.split("."),o=0,s=a.length;o<s-1;++o){var r=a[o];r in n&&(n=n[r])}return JSON.parse(JSON.stringify(n[a[o]]||{}))}function mt(t){var e=t.event,i=t.id;vt.call(this,{event:e,id:i});var a=this.state,o=a.selected;ht(a.sketchupMap[i]),a.sketchupMap[i].active=!0,e.ctrlKey?o.push(a.sketchupMap[i]):o=[a.sketchupMap[i]],a.selected=o,this.$emit("selected",a.selected),n["a"].set(a,"sketchup",a.sketchup)}function vt(t){for(var e=t.event,i=t.id,n=void 0===i?null:i,a=this.state,o=a.selected,s=a.sketchupMap[n]||{},r=0;r<o.length;r++){var c=o[r];if(c.id!==s.parentId&&a.sketchupMap[c.id]){var l=a.sketchupMap[c.id].parentId,h=!1;while(l){if(l===s.parentId){e.ctrlKey||(ht(a.sketchupMap[c.id]),h=!0);break}ht(a.sketchupMap[l]),l=a.sketchupMap[l].parentId,h=!0}h&&(o.splice(r,1),r--)}}a.selected=o}function gt(t,e){var i=e.id;if(t.sketchupMap[i]=e,e.children&&e.children.length)for(var n=0;n<e.children.length;++n)gt(t,e.children[n])}var yt=function t(){return Object(rt["a"])(this,t),this.init||(this.init=!0,this.bus=new n["a"]({computed:{selected:function(){return JSON.parse(JSON.stringify(this.state.selected))}},data:function(){return{state:{sketchup:{},sketchupMap:{},selected:[],copyData:null,snapshotStack:[],snapshotLength:30,snapshotIndex:-1}}},created:function(){var t=this;this.$on("addToSketch",(function(e){var i=e.parent,n=void 0===i?null:i,a=e.item,o=e.index,s=void 0===o?-1:o,r=t.state,c=[];n=n||r.sketchup,tt(a)?a.forEach((function(t){t=JSON.parse(JSON.stringify(t)),n.type===ct.type?(t=lt(r,t,n),c.push(t.id),-1===s?r.sketchupMap[n.id].children.push(t):r.sketchupMap[n.id].children.splice(s,0,t)):(t=lt(r,t,r.sketchup),c.push(t.id),-1===s?r.sketchup.children.push(t):r.sketchup.children.splice(s,0,t))})):(a=JSON.parse(JSON.stringify(a)),a=lt(r,a,n),c.push(a.id),n?-1===s?r.sketchupMap[n.id].push(a):r.sketchupMap[n.id].splice(s,0,a):-1===s?r.sketchup.children.push(a):r.sketchup.children.splice(s,0,a)),t.$nextTick((function(){t.$emit("updateGroup"),t.$emit("addend",c)}))})),this.$on("select",(function(e){var i=e.event,n=void 0===i?{}:i,a=e.id,o=void 0===a?null:a,s=t.state;if(o){var r=s.sketchupMap[o],c=-1;c=s.selected.findIndex((function(t){return t.id==r.id})),(c>-1&&n.ctrlKey||c<0)&&mt.call(t,{event:n,id:o})}})),this.$on("unSelect",(function(e){var i=e.event,a=void 0===i?{}:i,o=e.id,s=t.state;vt.call(t,{event:a,id:o}),t.$emit("selected",s.selected),n["a"].set(s,"sketchup",s.sketchup)})),this.$on("cleanSelect",(function(){var e=t.state,i=e.selected.length-1;while(i>=0){var a=e.selected[i];if(!a||!a.parentId)break;vt.call(t,{event:{ctrlKey:!1},id:null}),--i}e.selected=[],t.$emit("selected",e.selected),n["a"].set(e,"sketchup",e.sketchup)})),this.$on("updateSelected",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=t.state;if(e&&(!e||0!==Object.keys(e).length)){var a=i.selected[i.selected.length-1]||null;if(a&&!(a.length>1)){var o={ids:a.id,data:{}};for(var s in e)o.data[s]=ft(i.sketchupMap[a.id],s),pt(i.sketchupMap[a.id],s,e[s],t);n["a"].set(i,"sketchup",i.sketchup)}}})),this.$on("removeSelected",(function(){var e,i,a=t.state,o=a.selected,s=!1,r=a.sketchupMap;tt(o)&&o.length&&(s=!0,o.map((function(n){e=r[r[n.id].parentId],t.$emit("unSelect",{id:n.id}),e?(i=e.children.findIndex((function(t){return t.id===n.id})),e.children.splice(i,1)):(i=a.sketchup.children.findIndex((function(t){return t.id===n.id})),a.sketchup.children.splice(i,1)),a.sketchupMap[n.id].children.map((function(t){delete a.sketchupMap[t.id]})),delete a.sketchupMap[n.id]}))),t.$emit("updateGroup"),s&&n["a"].set(a,"sketchup",a.sketchup)})),this.$on("copySelected",(function(e){t.state.copyData=JSON.parse(JSON.stringify(e))})),this.$on("paste",(function(){var e=t.state;if(e.copyData){t.$emit("recordShot");var i=JSON.parse(JSON.stringify(e.copyData)),n=i.length>0,a=e.selected[0]?e.selected[0].parentId:null;i.forEach((function(t){t.left+=10,t.top+=10,t=lt(e,t,{id:a}),a?e.sketchupMap[a].children.push(t):e.sketchup.children.push(t)}));var o=JSON.parse(JSON.stringify(e.selected));o.forEach((function(e){t.$emit("unSelect",{id:e.id,event:{ctrlKey:!1}})})),i.forEach((function(e){t.$emit("select",{id:e.id,event:{ctrlKey:n}})})),e.copyData=JSON.parse(JSON.stringify(i)),t.$emit("updateGroup")}})),this.$on("group",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.state;e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault();var a=i.selected;if(tt(a)&&a.length>1){var o=i.selected[0].parentId,s=JSON.parse(JSON.stringify(ct)),r=it(a);s=Object(q["a"])(Object(q["a"])({},s),r),s=lt(i,s,{id:o}),ut(i,a,o?i.sketchupMap[o].children:i.sketchup.children,i.sketchupMap[s.id].children,s,r),t.$emit("unSelect",{id:s.id}),t.$emit("select",{id:s.id}),n["a"].set(i,"sketchup",i.sketchup)}})),this.$on("breakGroup",(function(){var e,i=t.state,n=i.selected;if(n&&0!==n.length&&0!==Object.keys(n).length)if(tt(n))n.map((function(n){var a=n.left,o=n.top,s=n.parentId,r=s,c=i.sketchupMap[r]?i.sketchupMap[r].children:i.sketchup.children;e={left:a,top:o},n.type===ct.type&&n.children.length&&(t.$emit("unSelect",{event:{ctrlKey:!1},id:n.id}),dt(i,n,c,e,r),n.children.map((function(e){t.$emit("unSelect",{event:{ctrlKey:!0},id:e.id}),t.$emit("select",{event:{ctrlKey:!0},id:e.id})})))}));else{var a=n.left,o=n.top,s=n.parentId,r=s,c=i.sketchupMap[r]?i.sketchupMap[r].children:i.sketchup.children;e={left:a,top:o},n.type===ct.type&&n.children.length&&(dt(i,n,c,e,r),t.$emit("cleanSelect"),n.children.map((function(e){t.$emit("unSelect",{event:{ctrlKey:!0},id:e.id}),t.$emit("select",{event:{ctrlKey:!0},id:e.id})})))}})),this.$on("updateGroupBox",(function(e){var i=e.id,n=e.coord,a=t.state;a.sketchupMap[i]&&(a.sketchupMap[i].left=a.sketchupMap[i].left+n.left,a.sketchupMap[i].top=a.sketchupMap[i].top+n.top,a.sketchupMap[i].width=n.width,a.sketchupMap[i].height=n.height,a.sketchupMap[i].children.map((function(t){a.sketchupMap[t.id].left=a.sketchupMap[t.id].left-n.left,a.sketchupMap[t.id].top=a.sketchupMap[t.id].top-n.top})))})),this.$on("initTree",(function(e){var i=t.state;i.sketchupMap={},i.sketchup={},i.selected=[],i.copyData=null,e.type="sketchup",e=JSON.parse(JSON.stringify(e)),e=lt(i,e,{}),i.sketchup=e})),this.$on("updateItem",(function(e){var i=e.id,a=e.data,o=void 0===a?null:a,s=e.updateGroupBox,r=void 0===s||s,c=t.state;if(o&&c.sketchupMap[i]){var l={ids:i,data:{}};for(var h in o)r&&(l.data[h]=ft(c.sketchupMap[i],h)),pt(c.sketchupMap[i],h,o[h],t);r&&t.$emit("updateGroup"),n["a"].set(c,"sketchup",c.sketchup)}})),this.$on("bringForward",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],s=o.children.findIndex((function(t){return t.id===i}));s!==o.children.length-1&&(n.sketchupMap[a.parentId].children[s]=n.sketchupMap[a.parentId].children.splice(s+1,1,n.sketchupMap[a.parentId].children[s])[0])}})),this.$on("sendBackward",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],s=o.children.findIndex((function(t){return t.id===i}));0!==s&&(n.sketchupMap[a.parentId].children[s]=n.sketchupMap[a.parentId].children.splice(s-1,1,n.sketchupMap[a.parentId].children[s])[0])}})),this.$on("bringToFront",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],s=o.children.findIndex((function(t){return t.id===i}));s!==o.children.length-1&&n.sketchupMap[a.parentId].children.push(n.sketchupMap[a.parentId].children.splice(s,1)[0])}})),this.$on("sendToBack",(function(e){var i=e.id,n=t.state,a=n.sketchupMap[i];if(a){var o=n.sketchupMap[a.parentId],s=o.children.findIndex((function(t){return t.id===i}));0!==s&&n.sketchupMap[a.parentId].children.unshift(n.sketchupMap[a.parentId].children.splice(s,1)[0])}})),this.$on("recordShot",(function(){t.state.snapshotStack[++t.state.snapshotIndex]={select:JSON.parse(JSON.stringify(t.state.selected)),data:JSON.parse(JSON.stringify(t.state.sketchup))},t.state.snapshotStack.length>t.state.snapshotLength&&(t.state.snapshotStack.shift(),t.state.snapshotIndex--)})),this.$on("undo",(function(){if(t.state.snapshotIndex>=0){t.state.sketchupMap={};var e=t.state.snapshotStack[t.state.snapshotIndex];if(!e)return;t.state.snapshotIndex--,gt(t.state,e.data),e.select=e.select||[],t.state.selected=[],e.select.forEach((function(e){t.state.selected.push(t.state.sketchupMap[e.id])})),n["a"].set(t.state,"sketchup",e.data)}})),this.$on("redo",(function(){if(t.state.snapshotIndex<=t.state.snapshotStack.length){t.state.sketchupMap={},t.state.snapshotIndex++;var e=t.state.snapshotStack[t.state.snapshotIndex];if(!e)return;gt(t.state,e.data),t.state.selected=e.select,n["a"].set(t.state,"sketchup",e.data)}}))},methods:{updateConfig:function(t){this.state.snapshotLength=t.snapshotLength?t.snapshotLength:this.state.snapshotLength}}})),this.bus},bt=new yt,kt={name:"dragdropbox",props:{renderData:{type:Object,required:!0}},mounted:function(){bt.$on("updateGroup",this.trigger)},methods:{trigger:function(){var t=this;this.$nextTick((function(){bt.$emit("updateGroupBox",{id:t.renderData.id,coord:Object(q["a"])({},it(t.renderData.children))})}))}},beforeDestroy:function(){bt.$off("updateGroup",this.trigger)}},xt=kt,wt=(i("b64f"),Object(c["a"])(xt,K,V,!1,null,"2c748eec",null)),St=wt.exports,Mt={name:"resizeable",components:{pdDragResizeRotate:$,dragdropbox:St},props:{element:{type:Object,default:function(){return null}},zIndex:{type:Number,default:0},activeable:{type:Boolean,default:!0},shiftKey:{type:Boolean,default:!1},scale:{type:[String,Number],default:1},rulerScale:{type:[String,Number],default:1}},computed:{selected:function(){return bt.selected},isLock:function(){return this.shiftKey}},data:function(){return{orPos:{},diffPos:{left:0,top:0},vLine:[],hLine:[],sticks:["tl","tm","tr","mr","ml","bl","bm","br","angle"]}},methods:{getRefLineParams:function(t){var e=t.vLine,i=t.hLine,n=0;this.vLine=e.map((function(t){return t["id"]=++n,t})),this.hLine=i.map((function(t){return t["id"]=++n,t}))},select:function(t){bt.$emit("select",t)},dragStart:function(t){var e=this;this.selected.forEach((function(t){e.orPos[t.id]={top:t.top,left:t.left}})),this.diffPos={left:t.left,top:t.top},bt.$emit("recordShot")},dragging:function(t){var e=this,i=t.top,n=t.left;if(this.selected.length>1){var a=i-this.diffPos.top,o=n-this.diffPos.left;this.selected.forEach((function(t){if(t.id!==e.element.id){var i=e.orPos[t.id].left+e.px2mm(o),n=e.orPos[t.id].top+e.px2mm(a);bt.$emit("updateItem",{id:t.id,data:{left:i,top:n},updateGroupBox:!1})}}))}},dragStop:function(t){if(1===this.selected.length){var e=t.left,i=t.top,n=t.width,a=t.height,o=t.rotate;e=this.px2mm(e),i=this.px2mm(i),n=this.px2mm(n),a=this.px2mm(a),bt.$emit("updateItem",{id:this.element.id,data:{left:e,top:i,width:n,height:a,rotate:o},updateGroupBox:!0})}else{var s=t.left,r=t.top,c=t.width,l=t.height,h=t.rotate;s=this.px2mm(s),r=this.px2mm(r),c=this.px2mm(c),l=this.px2mm(l),bt.$emit("updateItem",{id:this.element.id,data:{left:s,top:r,width:c,height:l,rotate:h},updateGroupBox:!1}),bt.$emit("updateGroup")}},resizeStart:function(){bt.$emit("recordShot")},resizeStop:function(t){var e=t.left,i=t.top,n=t.width,a=t.height,o=t.rotate;e=this.px2mm(e),i=this.px2mm(i),n=this.px2mm(n),a=this.px2mm(a),bt.$emit("updateSelected",{left:e,top:i,width:n,height:a,rotate:o}),bt.$emit("updateGroup")},rotateStart:function(){bt.$emit("recordShot")},rotateStop:function(t){var e=t.left,i=t.top,n=t.width,a=t.height,o=t.rotate;e=this.px2mm(e),i=this.px2mm(i),n=this.px2mm(n),a=this.px2mm(a),bt.$emit("updateSelected",{left:e,top:i,width:n,height:a,rotate:o}),bt.$emit("updateGroup")},beforeSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.element;this.activeable?this.select({event:t,id:e.id}):this.$emit("parentSelect",t,e)},parentActiveChild:function(){this.activeable?this.element.children.length&&this.element.active&&(tt(this.selected)&&this.selected.length>1?(this.cleanSelect(),this.select({id:this.element.id})):this.element.childActiveAble=!0):this.$emit("parentActiveChild")},draggable:function(t){return this.selected.findIndex((function(e){return e.id===t}))>-1},resizeable:function(t){var e=t.id;return"dragdropbox"!=t.type&&(!(this.selected.length>1)&&this.selected.findIndex((function(t){return t.id===e}))>-1)},rotateable:function(t){var e=t.id;if("dragdropbox"==t.type)return!1;if(this.selected.length>1)return!1;var i=this.element.rotateable&&this.selected.findIndex((function(t){return t.id===e}))>-1||!1;return i},setDragDropBoxClass:function(){return"dragdropbox"==this.element.type&&this.element.active&&!this.element.childActiveAble?"box-active dragdropbox":"dragdropbox"==this.element.type&&this.element.active&&this.element.childActiveAble?"dragdropbox":"dragdropbox"!=this.element.type||this.element.active?"":"noborder dragdropbox"},mm2px:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return parseFloat((Number(t)*this.scale).toFixed(1))},px2mm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return parseFloat((Number(t)/this.scale).toFixed(1))}}},$t=Mt,Lt=(i("5345"),Object(c["a"])($t,J,G,!1,null,"1325e3e2",null)),Ct=Lt.exports,It=function(t){this.api=this.builder(),this.api.constructRulers.call(this,t)};It.prototype.builder=function(){var t,e=1,i=2,n=0,a=0,o=1,s={},r=[],c=document.createElement("div"),l=[],h={rulerHeight:15,fontFamily:"arial",fontSize:"8px",strokeStyle:"gray",sides:["top","left"],cornerSides:["TL"],lineWidth:1,enableMouseTracking:!0,enableToolTip:!0},u=function(t,e){var i="rotate("+e+"deg)",n=It.prototype.utils.pixelize(Math.abs(parseInt(t.canvas.style.left)))+" 100%";t.canvas.style.webkitTransform=i,t.canvas.style.MozTransform=i,t.canvas.style.OTransform=i,t.canvas.style.msTransform=i,t.canvas.style.transform=i,t.canvas.style.webkitTransformOrigin=n,t.canvas.style.MozTransformOrigin=n,t.canvas.style.OTransformOrigin=n,t.canvas.style.msTransformOrigin=n,t.canvas.style.transformOrigin=n},d=function(t,e){switch(t.canvas.style.left=It.prototype.utils.pixelize(-(t.canvas.width/2-t.canvas.height)),e){case"top":t.orgPos=parseInt(t.canvas.style.left);break;case"left":t.canvas.style.top=It.prototype.utils.pixelize(-t.canvas.height-1),t.orgPos=parseInt(t.canvas.style.top),u(t,90);break}},p=function(t,e){var i=function(t){t.preventDefault(),t.stopPropagation(),f(e.dimension,t.clientX,t.clientY,t)};e.canvas.addEventListener("mousedown",i),e.clearListeners=function(){e.canvas.removeEventListener("mousedown",i)}},f=function(i,s,l,h,u){var d,p=function(i,n,a){var o=i.dimension===e?n:a;i.assigned()?o<t.rulerHeight&&(r.some((function(t,e){if(t.line===i)return d=e,!0})),i.destroy(),r.splice(d,1)):o>t.rulerHeight&&i.assigned(!0)},f=document.createElement("div"),m=i===e?"rul_lineVer":"rul_lineHor",v=i===e?n:a;f.title="双击删除",It.prototype.utils.addClasss(f,["rul_line",m]),f=c.appendChild(f),i===e?(f.style.left=It.prototype.utils.pixelize(s-t.container.getBoundingClientRect().left),u&&(f.style.left=It.prototype.utils.pixelize(Math.round(s/o)+t.rulerHeight))):(f.style.top=It.prototype.utils.pixelize(l-t.container.getBoundingClientRect().top),u&&(f.style.top=It.prototype.utils.pixelize(Math.round(l/o)+t.rulerHeight))),r.push({dimension:i,line:It.prototype.guideLine(f,t.container.querySelector(".rul_wrapper"),i,t,v,p,h)})},m=function(n,a){var o,r="left"===a||"right"===a?e:i,c=r===e?"rul_ruler_Vertical":"rul_ruler_Horizontal",l=document.createElement("canvas");It.prototype.utils.addClasss(l,["rul_ruler",c,"rul_align_"+a]),o=n.appendChild(l),s[a]=It.prototype.rulerConstructor(o,t,r),s[a].drawRuler(n,t.rulerHeight),d(s[a],a),p(n,s[a])},v=function(){function e(e,i){var n=document.createElement("div"),a="rul_corner"+i.toUpperCase();n.title="点击 清除辅助线",It.prototype.utils.addClasss(n,["rul_corner",a]),n.style.width=It.prototype.utils.pixelize(t.rulerHeight+1),n.style.height=It.prototype.utils.pixelize(t.rulerHeight);var o=e.appendChild(n),s=document.createElement("div");s.style.position="absolute",s.style.height=It.prototype.utils.pixelize(t.rulerHeight),s.style.left=0,s.style.right=0,s.style.background="#fff",e.appendChild(s);var r=document.createElement("div");return r.style.position="absolute",r.style.width=It.prototype.utils.pixelize(t.rulerHeight),r.style.top=0,r.style.bottom=0,r.style.background="#fff",e.appendChild(r),o}function i(t){t.stopPropagation(),t.preventDefault(),S()}return function(t,n){n.forEach((function(n){var a=e(t,n);a.addEventListener("mousedown",i),a.destroy=function(){a.removeEventListener("mousedown",i),a.parentNode.removeChild(a)},l.push(a)}))}}(),g=function(t){r.forEach((function(t){t.line.stopDrag()}))},y=function(e){c=It.prototype.utils.addClasss(c,"rul_wrapper"),t=It.prototype.utils.extend(h,e),c=t.container.appendChild(c),t.sides.forEach((function(t){m(c,t)})),v(c,t.cornerSides),t.container.addEventListener("mouseup",g)},b=function(t){var e=0;for(var i in s)s.hasOwnProperty(i)&&t(s[i],e++)},k=function(t){var o,s=0,c=0,l=0;b((function(i){i.dimension===e?(o=i.canvas.style.top,i.canvas.style.top=It.prototype.utils.pixelize(i.orgPos+parseInt(t.y)),l=parseInt(o)-parseInt(i.canvas.style.top)):(s=i.canvas.style.left,i.canvas.style.left=It.prototype.utils.pixelize(i.orgPos+parseInt(t.x)),c=parseInt(s)-parseInt(i.canvas.style.left))})),r.forEach((function(e){e.dimension===i?(e.line.guideLine.style.top=It.prototype.utils.pixelize(parseInt(e.line.guideLine.style.top)-l),e.line.curPosDelta(parseInt(t.y))):(e.line.guideLine.style.left=It.prototype.utils.pixelize(parseInt(e.line.guideLine.style.left)-c),e.line.curPosDelta(parseInt(t.x)))})),n=parseInt(t.x),a=parseInt(t.y)},x=function(e){var s,c,l;b((function(t){t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.context.beginPath(),t.setScale(e),t.context.stroke(),o=e})),r.forEach((function(o){o.dimension===i?(s=parseInt(o.line.guideLine.style.top),c=t.rulerHeight+1,l=parseFloat(e)/o.line.curScale(),o.line.guideLine.style.top=It.prototype.utils.pixelize((s-c-a)/l+c+a),o.line.curScale(e)):(s=parseInt(o.line.guideLine.style.left),c=t.rulerHeight+1,l=parseFloat(e)/o.line.curScale(),o.line.guideLine.style.left=It.prototype.utils.pixelize((s-c-n)/l+c+n),o.line.curScale(e))}))},w=function(t){b((function(e){e.setUnit(t)}))},S=function(){r.forEach((function(t){t.line.destroy()})),r=[]},M=function(t){var e=t?"show":"hide";r.forEach((function(t){t.line[e]()}))},$=function(e){var i=e?"block":"none";c.style.display=i;var n=t.container.querySelectorAll(".rul_tracker");n.length>0&&(n[0].style.display=i,n[1].style.display=i)},L=function(){return r.map((function(e){return{posX:Math.round((parseInt(e.line.guideLine.style.left)-n-t.rulerHeight)*o),posY:Math.round((parseInt(e.line.guideLine.style.top)-a-t.rulerHeight)*o),dimension:e.dimension}}))},C=function(t){t&&t.forEach((function(t){f(t.dimension,t.posX,t.posY,null,!0)}))},I=function(){S(),b((function(t){t.destroy()})),l.forEach((function(t){t.destroy()})),t.container.removeEventListener("mouseup",g),c.parentNode.removeChild(c)};return{VERTICAL:e,HORIZONTAL:i,setPos:k,setScale:x,setUnit:w,clearGuides:S,getGuides:L,setGuides:C,constructRulers:y,toggleRulerVisibility:$,toggleGuideVisibility:M,destroy:I}},It.prototype.rulerConstructor=function(t,e,i){var n=t,a=n.getContext("2d"),o=0,s=0,r=1,c="px",l=i||2,h=0,u=document.createElement("div"),d=function(){return s},p=function(){return o},f=function(){return r},m=function(t){return r=parseFloat(t),y(),r},v=function(t){return c=t,y(),c},g=function(t,i,c){t,s=n.width=12e3,o=n.height=i,r=c||r,a.fillStyle="#fff",a.fillRect(0,0,s,o),a.strokeStyle=e.strokeStyle,a.font=e.fontSize+" "+e.fontFamily,a.lineWidth=e.lineWidth,a.beginPath(),a.fillStyle="#0006",y(),a.stroke()},y=function(){var t=0,e="",i=0,n=!1,l=0,h=o/2,u=o/2+2;if("px"==c)for(var d=0;d<=s;d+=1)i=s/2-d,n=!1,e="",i%50===0?(t=l,e=Math.round(-i*r),n=!0):i%25===0?(t=h,n=!0):i%5===0&&(t=u,n=!0),n&&(a.moveTo(d+.5,o+.5),a.lineTo(d+.5,t+.5),a.fillText(e,d+1.5,o/2+1));else{var p=parseFloat((1/r).toFixed(2));for(d=0;d<=s;d+=p)i=s/2-d,n=!1,e=Math.round(-i*r),e%20===0?(t=l,n=!0):e%10===0&&(e="",t=h,n=!0),n&&(a.moveTo(d+.5,o+.5),a.lineTo(d+.5,t+.5),a.fillText(e,d+1.5,o/2+1))}},b=function(t){var i=t.clientX,n=t.clientY;t.preventDefault(),2===l?u.style.left=It.prototype.utils.pixelize(i-parseInt(e.container.getBoundingClientRect().left)):u.style.top=It.prototype.utils.pixelize(n-parseInt(e.container.getBoundingClientRect().top))},k=function(){e.container.removeEventListener("mousemove",b),u.parentNode.removeChild(u),this.clearListeners&&this.clearListeners()},x=function(){u=e.container.appendChild(u),It.prototype.utils.addClasss(u,"rul_tracker");var t=It.prototype.utils.pixelize(e.rulerHeight);2===l?(u.style.height=t,u.style.top=0,u.style.bottom=0):(u.style.width=t,u.style.right=0,u.style.left=0),e.container.addEventListener("mousemove",b)};return e.enableMouseTracking&&x(),{getLength:d,getThickness:p,getScale:f,setScale:m,dimension:l,orgPos:h,canvas:n,context:a,drawRuler:g,drawPoints:y,destroy:k,setUnit:v}},It.prototype.guideLine=function(t,e,i,n,a,o,s){var r,c=t,l=1,h=!1,u=a||0,d=e,p=i||2,f=(o=o||function(){},function(t){return"undefined"===typeof t?u:u=t}),m=function(t){return"undefined"===typeof t?h:h=t},v=function(t){return"undefined"===typeof t?l:l=t},g=function(){return{move:function(t,e){c.style.left=It.prototype.utils.pixelize(t),c.style.top=It.prototype.utils.pixelize(e),b(t,e),o(r,t,e)},startMoving:function(t){It.prototype.utils.addClasss(c,["rul_line_dragged"]),t=t||window.event;var e=t?t.clientX:0,i=t?t.clientY:0,a=parseInt(c.style.top||0),o=parseInt(c.style.left||0),s=parseInt(c.offsetWidth),r=parseInt(c.offsetHeight),l=parseInt(d.offsetWidth),h=parseInt(d.offsetHeight),u=2===p?"ns-resize":"ew-resize";n.container.style.cursor=u,c.style.cursor=u;var f=e-o,m=i-a;document.onmousemove=function(t){t=t||window.event;var e=t.clientX,i=t.clientY,n=e-f,a=i-m;n<0&&(n=0),a<0&&(a=0),n+s>l&&(n=l-s),a+r>h&&(a=h-r),g.move(n,a)},y()},stopMoving:function(){n.container.style.cursor=null,c.style.cursor=null,document.onmousemove=function(){},k(),It.prototype.utils.removeClasss(c,["rul_line_dragged"])}}}(),y=function(t){n.enableToolTip&&It.prototype.utils.addClasss(c,"rul_tooltip")},b=function(t,e){c.dataset.tip=e?"Y: "+Math.round((e-n.rulerHeight-1-u)*l):"X: "+Math.round((t-n.rulerHeight-1-u)*l)},k=function(t){It.prototype.utils.removeClasss(c,"rul_tooltip")},x=function(){g.stopMoving(),o=null,c.removeEventListener("mousedown",M),c.removeEventListener("mouseup",$),c.removeEventListener("dblclick",L),c.parentNode&&c.parentNode.removeChild(c)},w=function(){c.style.display="none"},S=function(){c.style.display="block"},M=function(t){t.stopPropagation(),t.preventDefault(),g.startMoving()},$=function(t){g.stopMoving()},L=function(t){t.stopPropagation(),x()};return c.addEventListener("mousedown",M),c.addEventListener("mouseup",$),c.addEventListener("dblclick",L),s&&g.startMoving(s),r={setAsDraggable:g,startDrag:g.startMoving,stopDrag:g.stopMoving,destroy:x,curScale:v,assigned:m,curPosDelta:f,guideLine:c,dimension:p,hide:w,show:S},r},It.prototype.utils={extend:function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[t].hasOwnProperty(e)&&(arguments[0][e]=arguments[t][e]);return arguments[0]},pixelize:function(t){return t+"px"},prependChild:function(t,e){return t.insertBefore(e,t.firstChild)},addClasss:function(t,e){return e instanceof Array||(e=[e]),e.forEach((function(e){t.className+=" "+e})),t},removeClasss:function(t,e){var i=t.className;return e instanceof Array||(e=[e]),e.forEach((function(t){i=i.replace(t,"")})),t.className=i,t}};var Dt,Ot,Nt,Et,zt=It,Tt=(i("2531"),i("bee2")),Pt={x:0,y:0,scale:1,maxScale:3,minScale:.5,moving:!0,speed:.2,origin:"0,0,0"},Rt=function(){function t(e){Object(rt["a"])(this,t),this.$config=Object.assign({},Pt,e);var i=this.$config,n=i.zoomDom,a=i.eventDom;this.zoomDom=n,this.eventDom=a,this.zoomDom.style.transform="matrix(1,0,0,1,0,0)",this.center(),this.lastPos()}return Object(Tt["a"])(t,[{key:"center",value:function(){this.$config.x=this.eventDom.offsetWidth/2-this.zoomDom.offsetWidth/2,this.$config.y=this.$config.y||30,this.moveTo(this.$config.scale,{x:this.$config.x,y:this.$config.y})}},{key:"cal",value:function(t){var e=this,i=e.eventDom,n=e.$config.x,a=e.$config.y,o=e.$config.scale,s=t.wheelDelta<=0?o-e.$config.speed:o+e.$config.speed;if(s=Number(s.toFixed(2)),s>=e.$config.maxScale||s<=e.$config.minScale)return!1;var r=Number(parseFloat(s/o).toFixed(2));if(s<=.1)return!1;var c=t.clientX-e.getRect(i).left,l=t.clientY-e.getRect(i).top,h=Number(parseFloat(r*n+(1-r)*c).toFixed(2)),u=Number(parseFloat(r*a+(1-r)*l).toFixed(2));return e.$config.x=h,e.$config.y=u,e.$config.scale=s,e.matrixTo(),e.lastPos(),e.$config.cal&&e.$config.cal(e.$config),e.$config.scale}},{key:"getRect",value:function(t){return t.getBoundingClientRect()}},{key:"zoomIn",value:function(t){this.cal({wheelDelta:0,clientX:this.getRect(this.eventDom).width/2,clientY:this.getRect(this.eventDom).height/2})}},{key:"zoomOut",value:function(t){this.cal({wheelDelta:1,clientX:this.getRect(this.eventDom).width/2,clientY:this.getRect(this.eventDom).height/2})}},{key:"zoom",value:function(t){return this.cal(t)}},{key:"moveTo",value:function(t,e){this.$config.scale=t||this.$config.scale,this.$config.x=e.x?e.x:this.$config.x,this.$config.y=e.y?e.y:this.$config.y,this.matrixTo()}},{key:"move",value:function(t){var e=this;e.canMove&&(e.$config.x=e.$oldPos.x+t.clientX-e.moveStart.clientX,e.$config.y=e.$oldPos.y+t.clientY-e.moveStart.clientY,this.matrixTo(),e.$config.move&&e.$config.move(t))}},{key:"matrixTo",value:function(){var t=this;t.zoomDom.style.transform=Dt.getMatrix({x:t.$config.scale,y:t.$config.scale},{x:t.$config.x,y:t.$config.y})}},{key:"addMask",value:function(){var t=this;t.maskLoad||(t.mask||(t.mask=document.createElement("div"),t.mask.style.zIndex=999,t.mask.style.position="absolute",t.mask.style.top=0,t.mask.style.right=0,t.mask.style.left=0,t.mask.style.bottom=0,t.mask.addEventListener("mousedown",(function(e){0===e.button&&(e.stopPropagation(),t.getStartPos(e),t.canMove=!0)}))),t.eventDom.append(t.mask),t.maskLoad=!0)}},{key:"removeMask",value:function(){var t=this;t.mask&&t.mask.remove(),t.maskLoad=!1}},{key:"getStartPos",value:function(t){this.moveStart=t}},{key:"lastPos",value:function(t){var e=this,i=this.zoomDom.style.transform.replace(/^matrix(3d)?\((.*)\)$/,"$2").split(/, /);this.$oldPos={x:parseFloat(i[4],3),y:parseFloat(i[5],3),scale:parseFloat(i[0],3)},e.canMove=!1,t&&e.$config.moveStop&&e.$config.moveStop(t)}}]),t}();function _t(t){"SPACE"==t.code.toUpperCase()&&(Ot.addMask(),t.stopPropagation())}function At(){Ot.removeMask()}function Ht(t){Ot.move(t)}function jt(t){0===t.button&&Ot.lastPos(t)}function Xt(t){(!0===t.ctrlKey||t.metaKey)&&(Ot.zoom(t),t.preventDefault())}Dt={getMatrix:function(t,e){var i=1,n=1,a=0,o=0,s=t.x?t.x:1,r=t.y?t.y:1,c=e.x?e.x:0,l=e.y?e.y:0;return s=Number(s),r=Number(r),c=Number(c),l=Number(l),isNaN(s)||isNaN(r)||isNaN(c)||isNaN(l)?(console.warn("isNaN with scale"),"matrix(1,0,0,1,0,0)"):"matrix("+s*i+",0,0,"+r*n+","+(a+c)+","+(o+l)+")"}};var Yt={bind:function(){},inserted:function(t,e){Et=e.value;var i=15;Nt=t.ruler=new zt({container:t,rulerHeight:i,fontFamily:"arial",fontSize:"10px",strokeStyle:"#D6D6D6",lineWidth:1,enableMouseTracking:!0,enableToolTip:!1}),window.Ruler=Nt,Ot=t.panmove=new Rt({zoomDom:t.querySelector(".layer-box"),eventDom:t,moveStop:function(){Nt.api.setPos({x:Ot.$config.x-i,y:Ot.$config.y-i})},move:function(t){Nt.api.setPos({x:Ot.$config.x-i,y:Ot.$config.y-i})},cal:function(t){var e=parseFloat(parseFloat(1/(Et*t.scale)).toFixed(2));Nt.api.setScale(e),Nt.api.setPos({x:t.x-i,y:t.y-i}),bt.$emit("rulerScale",t.scale)}}),Nt.api.setScale(parseFloat(1/Et)||1),Nt.api.setUnit(1==Et?"px":""),bt.$on("initTree",(function(){bt.$nextTick((function(){Ot.center(),Ot.matrixTo(),Ot.lastPos(),Nt.api.setPos({x:Ot.$config.x-i,y:Ot.$config.y-i})}))})),Nt.api.setPos({x:Ot.$config.x-i,y:Ot.$config.y-i}),document.body.addEventListener("keydown",_t),document.body.addEventListener("keyup",At),document.addEventListener("mousemove",Ht),document.addEventListener("mouseup",jt),document.addEventListener("mouseout",jt),document.addEventListener("mousewheel",Xt,{passive:!1})},unbind:function(){document.body.removeEventListener("keydown",_t),document.body.removeEventListener("keyup",At),document.removeEventListener("mousemove",Ht),document.removeEventListener("mouseup",jt),document.removeEventListener("mouseout",jt),document.removeEventListener("mousewheel",Xt)}},Wt=(i("bfe4"),"body"),Ft="fit",Bt=null,Jt=!1,Gt=null,Kt={},Vt={left:0,top:0,width:0,height:0},qt=document.createElement("div");qt.setAttribute("class","pd-frame-box");var Ut={bind:function(){},inserted:function(t){t.addEventListener("mousedown",Zt),document.addEventListener("mousemove",Qt),document.addEventListener("mouseup",te)},update:function(t,e){Gt="function"==typeof e.value.selected?e.value.selected:null,Wt=t,Bt=e.value.excluded||null,Ft=e.value.type||Ft},componentUpdated:function(){},unbind:function(t){t.removeEventListener("mousedown",Zt),document.removeEventListener("mousemove",Qt)}};function Zt(t){if(0===t.button&&!ot(t.target,"vdr")){"body"===Wt&&(Wt=document.querySelector(Wt));var e=Wt.getBoundingClientRect();nt(e,e,"pointer",t)?(Kt={},Jt=!0,Vt={left:t.pageX,top:t.pageY,width:0,height:0},qt.style.left=Vt.left+"px",qt.style.top=Vt.top+"px",qt.style.width=Vt.width,qt.style.height=Vt.height):Jt=!1}}function Qt(t){Jt&&(Jt&&Math.abs(t.pageX-Vt.left)>=10&&(document.body.contains(qt)||document.body.append(qt)),st(),t.pageX>=Vt.left&&(qt.style.width=t.pageX-Vt.left+1+"px"),t.pageX<Vt.left&&(qt.style.left=t.pageX+"px",qt.style.width=Vt.left-t.pageX+"px"),t.pageY>=Vt.top&&(qt.style.height=t.pageY-Vt.top+1+"px"),t.pageY<Vt.top&&(qt.style.top=t.pageY+"px",qt.style.height=Vt.top-t.pageY+"px"),Bt&&Bt.children.length&&et(ee,50)())}function te(t){Jt&&(Jt=!1,qt.remove(),Gt&&Object.keys(Kt).length&&Gt(Kt))}function ee(){Kt={},Bt.childNodes.forEach((function(t){t.hasAttribute("pd-id")&&nt(t.getBoundingClientRect(),qt.getBoundingClientRect(),Ft)&&(Kt[t.getAttribute("pd-id")]=!0)}))}var ie={data:function(){return{shiftKey:!1}},methods:{lock:function(t){var e=t.isLock,i=void 0!==e&&e;this.shiftKey=i},select:function(t){var e=t.id;this.$fire("select",{event:{ctrlKey:!1},id:e},!1)},move:function(t){var e=this,i=t.direction,n=tt(this.selected)?this.selected:[this.selected],a=this.$refs.resizeable[0];a&&n&&(n.forEach((function(t){var n=t.left,a=t.top;"up"==i?a-=1:"down"==i?a+=1:"left"==i?n-=1:"right"==i&&(n+=1),e.$fire("updateItem",{id:t.id,data:{left:parseFloat(n.toFixed(2)),top:parseFloat(a.toFixed(2))}})})),this.$fire("move",i,!0))},copy:function(){var t=this,e=this.selected;if(e.length>0){e=JSON.parse(JSON.stringify(e));var i=this.beforeCopy(e);Q(i)?i.then((function(e){t.$fire("copySelected",e,!1)})):this.$fire("copySelected",i,!1)}},paste:function(){this.$fire("paste")},undo:function(){this.$fire("undo")},redo:function(){},group:function(){this.$fire("group",null,!0)},breakGroup:function(){this.$fire("breakGroup",null,!0)},deleteSelect:function(){this.selected.length>0&&this.beforeDelete(this.selected)&&this.$fire("removeSelected",null,!0)},zIndex:function(t){var e=t.type,i=t.id;this.$fire(e,{id:i},!0)},cleanSelect:function(t){var e=t.e;e&&ot(e.target,"vdr")||this.selected.length<=0||this.$fire("cleanSelect")},initTree:function(t){var e=t.data,i=t.snapShot,n=void 0===i||i;this.$fire("initTree",e,n)},updateItem:function(t){var e=t.id,i=t.data,n=t.snapShot,a=void 0===n||n;this.$fire("updateItem",{id:e,data:i},a)},addToSketch:function(t){var e=t.parent,i=void 0===e?null:e,n=t.item,a=void 0===n?[]:n,o=t.snapShot,s=void 0===o||o;a.length>0&&this.$fire("addToSketch",{parent:i,item:a},s)}}},ne={name:"pdDragBase",mixins:[ie],directives:{pdRuler:Yt,frameselect:Ut},components:{resizeable:Ct},beforeMount:function(){var t=this;this.initTree({data:{type:"sketchup",width:10,height:10,to:0,left:0,children:[]},snapShot:!1}),bt.$on("rulerScale",(function(e){t.rulerScale=e}))},data:function(){return{vLine:[],hLine:[],rulerScale:1}},computed:{selected:function(){return bt.selected},sketchupData:function(){return bt.state.sketchup},getLayerSize:function(){var t=bt.state.sketchup;return{width:t.width*this.ruleConfig.scale+"px",height:t.height*this.ruleConfig.scale+"px"}}},props:{beforeCopy:{type:Function,default:function(t){return new Promise((function(e){e(t)}))}},beforeDelete:{type:Function,default:function(){return function(){return!0}}},beforeAdd:{type:Function,default:function(){return null}},ruleConfig:{type:Object,default:function(){return{scale:1,frameSelectType:"fit",stackLength:30}}}},methods:{getRefLineParams:function(t){var e=t.vLine,i=t.hLine,n=0;this.vLine=e.map((function(t){return t["id"]=++n,t})),this.hLine=i.map((function(t){return t["id"]=++n,t}))},frameselectEvt:function(t){if(Object.keys(t).length)for(var e in this.$fire("cleanSelect"),t)this.$fire("select",{event:{ctrlKey:!0},id:e})},$fire:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i&&bt.$emit("recordShot"),bt.$emit(t,e)},$bind:function(t,e){bt.$on(t,e)},$unbind:function(t,e){bt.$off(t,e)}},updated:function(){bt.state.snapshotLength!==this.ruleConfig.stackLength&&bt.updateConfig({snapshotLength:this.ruleConfig.stackLength})}},ae=ne,oe=(i("d535"),Object(c["a"])(ae,F,B,!1,null,"3dc73a34",null)),se=oe.exports,re=[se],ce=function t(e){t.installed||(re.map((function(t){e.component(t.name,t)})),"undefined"!==typeof window&&window.Vue&&t(window.Vue))},le={install:ce,components:re,pdDragBase:se};n["a"].use(W),n["a"].use(le),n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(h)}}).$mount("#app")},"6c16":function(t,e,i){"use strict";i("b5b0")},b0be:function(t,e,i){"use strict";i("b193")},b193:function(t,e,i){},b5b0:function(t,e,i){},b64f:function(t,e,i){"use strict";i("f005")},bfe4:function(t,e,i){},ca8c:function(t,e,i){"use strict";i("e1d9")},d535:function(t,e,i){"use strict";i("3591")},e1d9:function(t,e,i){},f005:function(t,e,i){},f345:function(t,e,i){"use strict";i("f54a")},f54a:function(t,e,i){}});
//# sourceMappingURL=app.34ad77b2.js.map